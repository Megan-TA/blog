{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"source/img/icon_wechat.png","path":"img/icon_wechat.png","modified":1,"renderable":0},{"_id":"source/img/article/tag.png","path":"img/article/tag.png","modified":1,"renderable":0},{"_id":"themes/hu/source/css/archive.styl","path":"css/archive.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/css/beantech.css","path":"css/beantech.css","modified":1,"renderable":1},{"_id":"themes/hu/source/css/beantech.min.css","path":"css/beantech.min.css","modified":1,"renderable":1},{"_id":"themes/hu/source/css/donate.css","path":"css/donate.css","modified":1,"renderable":1},{"_id":"themes/hu/source/css/highlight.styl","path":"css/highlight.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/css/hux-blog.min.css","path":"css/hux-blog.min.css","modified":1,"renderable":1},{"_id":"themes/hu/source/css/toc.styl","path":"css/toc.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/css/signature.styl","path":"css/signature.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/css/widget.styl","path":"css/widget.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/css/rocket.styl","path":"css/rocket.styl","modified":1,"renderable":1},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.eot","path":"fonts/glyphicons-halflings-regular.eot","modified":1,"renderable":1},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.ttf","path":"fonts/glyphicons-halflings-regular.ttf","modified":1,"renderable":1},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.woff","path":"fonts/glyphicons-halflings-regular.woff","modified":1,"renderable":1},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.woff2","path":"fonts/glyphicons-halflings-regular.woff2","modified":1,"renderable":1},{"_id":"themes/hu/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/hux-blog.js","path":"js/hux-blog.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/hux-blog.min.js","path":"js/hux-blog.min.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/jquery.tagcloud.js","path":"js/jquery.tagcloud.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/jquery.nav.js","path":"js/jquery.nav.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/totop.js","path":"js/totop.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/toc.js","path":"js/toc.js","modified":1,"renderable":1},{"_id":"themes/hu/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":1,"renderable":1},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.svg","path":"fonts/glyphicons-halflings-regular.svg","modified":1,"renderable":1},{"_id":"themes/hu/source/js/bootstrap.js","path":"js/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/hu/source/js/jquery.min.js","path":"js/jquery.min.js","modified":1,"renderable":1},{"_id":"source/img/header_img/about.jpg","path":"img/header_img/about.jpg","modified":1,"renderable":0},{"_id":"source/img/header_img/archive.jpg","path":"img/header_img/archive.jpg","modified":1,"renderable":0},{"_id":"source/img/header_img/archives-widget.jpg","path":"img/header_img/archives-widget.jpg","modified":1,"renderable":0},{"_id":"source/img/signature/BeanTechSign-white.png","path":"img/signature/BeanTechSign-white.png","modified":1,"renderable":0},{"_id":"themes/hu/source/css/bootstrap.css","path":"css/bootstrap.css","modified":1,"renderable":1},{"_id":"themes/hu/source/css/images/rocket.png","path":"css/images/rocket.png","modified":1,"renderable":1},{"_id":"themes/hu/source/css/images/ironman.png","path":"css/images/ironman.png","modified":1,"renderable":1},{"_id":"source/img/avatar/ironman.png","path":"img/avatar/ironman.png","modified":1,"renderable":0},{"_id":"source/img/signature/BeanTechSign-black.png","path":"img/signature/BeanTechSign-black.png","modified":1,"renderable":0},{"_id":"themes/hu/source/js/jquery.js","path":"js/jquery.js","modified":1,"renderable":1},{"_id":"source/img/article_header/article_bg.jpg","path":"img/article_header/article_bg.jpg","modified":1,"renderable":0},{"_id":"source/img/article/huweihuang_blog.png","path":"img/article/huweihuang_blog.png","modified":1,"renderable":0},{"_id":"source/img/blog.jpg","path":"img/blog.jpg","modified":1,"renderable":0},{"_id":"source/img/header_img/home.jpg","path":"img/header_img/home.jpg","modified":1,"renderable":0},{"_id":"source/img/header_img/tag.png","path":"img/header_img/tag.png","modified":1,"renderable":0},{"_id":"source/img/article_header/article_header.png","path":"img/article_header/article_header.png","modified":1,"renderable":0},{"_id":"source/img/header_img/home-bg-o.png","path":"img/header_img/home-bg-o.png","modified":1,"renderable":0},{"_id":"source/img/header_img/home2.png","path":"img/header_img/home2.png","modified":1,"renderable":0},{"_id":"source/img/header_img/404.png","path":"img/header_img/404.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/CNAME","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1560777628869},{"_id":"themes/hu/LICENSE","hash":"2b209f06bebeb2a8c2b7e187e436f3e1e1fbc8a7","modified":1560749588686},{"_id":"themes/hu/_config.yml","hash":"e800e32847df32dacddb5202823a004557023bcd","modified":1560749588686},{"_id":"source/404.md","hash":"8aa56af7bcd7cd23667cbf3eb5b5c9fa4533eb60","modified":1560749588590},{"_id":"source/_posts/python爬虫框架scrapy.md","hash":"76d22ddccadd1054452b9603a194069c522c9d2e","modified":1560924776092},{"_id":"source/_posts/nginx入门.md","hash":"7de7608cb4c4202bf9091756017d93d0d6bec245","modified":1560924137302},{"_id":"source/_posts/docker基本使用.md","hash":"1c6bb9408f90c447c6292fc619bbdc69b77c0b4e","modified":1560925125733},{"_id":"source/_posts/分享个人vscode常用插件.md","hash":"106e497aabbec064c0811e714d7415b143d43032","modified":1560924026621},{"_id":"source/_posts/利用verdaccio搭建私有npm仓库.md","hash":"82acd8cc995ca3bd275598dd5bd997a9ca889b02","modified":1560921854988},{"_id":"source/_posts/序.md","hash":"f6b814efcc0228443127066d69e86f8340f49dcf","modified":1560922368462},{"_id":"source/about/index.md","hash":"56b5f984a91bba5206db3b3fe1b1a02cf6f830e7","modified":1560780330081},{"_id":"source/archive/index.md","hash":"e4c40d8a769b9076bebf7b8a07f20a4e339a4804","modified":1560780627584},{"_id":"source/tags/index.md","hash":"4e62b153da9d097c43aa29bb1a37586bc47d5a62","modified":1560780601149},{"_id":"source/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1560749588682},{"_id":"themes/hu/languages_to_be_added/default.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1560749588687},{"_id":"themes/hu/languages_to_be_added/en.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1560749588687},{"_id":"themes/hu/languages_to_be_added/de.yml","hash":"424a9c1e6ab69334d7873f6574da02ca960aa572","modified":1560749588687},{"_id":"themes/hu/languages_to_be_added/es.yml","hash":"cb4eeca0ed3768a77e0cd216300f2b2549628b1b","modified":1560749588687},{"_id":"themes/hu/languages_to_be_added/no.yml","hash":"8ca475a3b4f8efe6603030f0013aae39668230e1","modified":1560749588688},{"_id":"themes/hu/languages_to_be_added/pl.yml","hash":"de7eb5850ae65ba7638e907c805fea90617a988c","modified":1560749588688},{"_id":"themes/hu/languages_to_be_added/zh-CN.yml","hash":"7bfcb0b8e97d7e5edcfca8ab26d55d9da2573c1c","modified":1560749588688},{"_id":"themes/hu/languages_to_be_added/ru.yml","hash":"42df7afeb7a35dc46d272b7f4fb880a9d9ebcaa5","modified":1560749588688},{"_id":"themes/hu/languages_to_be_added/zh-TW.yml","hash":"9acac6cc4f8002c3fa53ff69fb8cf66c915bd016","modified":1560749588688},{"_id":"themes/hu/layout/404.ejs","hash":"40de38bd399f6f4aef0d6c63c7b13b02d74f1c56","modified":1560749588688},{"_id":"themes/hu/layout/about.ejs","hash":"edcf8fa3bf7093c974d418ffef42ac89c19af128","modified":1560749588691},{"_id":"themes/hu/layout/archive.ejs","hash":"72a150c8dff0031a9107d12eaa7c2e6c6ce950d2","modified":1560749588691},{"_id":"themes/hu/layout/keynote.ejs","hash":"f5689862281e34dbe8402b0e72f632902e53e88b","modified":1560749588692},{"_id":"themes/hu/layout/index.ejs","hash":"dc8a6eaa00d1e7c33a40979afe0953ed5d7b512e","modified":1560749588691},{"_id":"themes/hu/layout/post.ejs","hash":"a36524a762090581a858ae55b62ca18e6251876a","modified":1560749588692},{"_id":"themes/hu/layout/page.ejs","hash":"5e588f200a7b7cd3ae40402b0dd3b779aac6787f","modified":1560749588692},{"_id":"themes/hu/layout/tags.ejs","hash":"2c72eb2e89130658aa068d80d27b561b509c5dcd","modified":1560749588693},{"_id":"themes/hu/layout/layout.ejs","hash":"a6f0f1369afaddf5b63cc04589f17dfee409fcd0","modified":1560778484013},{"_id":"source/img/article/tag.png","hash":"c8632d64d9471009098b84f70273e63037a4e7b8","modified":1560749588605},{"_id":"themes/hu/layout/_partial/footer.ejs","hash":"e69b7c4a446db77588b981521471194dff5fc5f7","modified":1560779737202},{"_id":"themes/hu/layout/_partial/nav.ejs","hash":"4c905166c960852e9b9a3c9d5c680091e37b481f","modified":1560749588689},{"_id":"themes/hu/layout/_partial/header.ejs","hash":"3bd09df76e0622d76d186b020393fcab361e6c97","modified":1560780687950},{"_id":"themes/hu/layout/_partial/head.ejs","hash":"7858f29b52340f2ba2fc52733167c802028820e5","modified":1560779411259},{"_id":"themes/hu/layout/_partial/pagination.ejs","hash":"557d6bb069a1d48af49ae912994653f44b32a570","modified":1560749588689},{"_id":"themes/hu/layout/_widget/category.ejs","hash":"1cf485def07dc06e870dc9613767c6c614bcf428","modified":1560749588690},{"_id":"themes/hu/layout/_partial/sidebar.ejs","hash":"2e4e528a555917b2a267da4db2440bcc4a7a65ab","modified":1560749588690},{"_id":"themes/hu/layout/_partial/toc.ejs","hash":"40e11b303df113c64a5ca35b79dd53c824010c09","modified":1560749588690},{"_id":"themes/hu/layout/_widget/archive.ejs","hash":"7594929d472806ca4c64d9906d9903a96de111a0","modified":1560749588690},{"_id":"themes/hu/layout/_widget/friends-blog.ejs","hash":"734d3775017aedac185028924baf890a71a74548","modified":1560749588691},{"_id":"themes/hu/layout/_widget/featured-tags.ejs","hash":"229b58f185955a9bfbc658fd00b3e7f3c69cbb2c","modified":1560952989975},{"_id":"themes/hu/layout/_widget/recent-posts.ejs","hash":"e08ab8ba60e31638006acf27f066b989a0a3c433","modified":1560749588691},{"_id":"themes/hu/layout/_widget/short-about.ejs","hash":"315de02246f07c747c32495e107ad7b19cb3ff54","modified":1560749588691},{"_id":"themes/hu/source/css/archive.styl","hash":"715bcbd085eb95ec26c9805c11c374919cde971c","modified":1560749588693},{"_id":"themes/hu/source/css/beantech.css","hash":"4c361354fd8e9851923fb21a620bc079380ebcd8","modified":1560749588693},{"_id":"themes/hu/source/css/beantech.min.css","hash":"05a06230b1a9eca0b30cece54a397008cb77dc50","modified":1560749588694},{"_id":"themes/hu/source/css/donate.css","hash":"f65ac8363d8d215adb896158e7b45165db259a47","modified":1560749588695},{"_id":"themes/hu/source/css/highlight.styl","hash":"e842080e6d580f0f70a7df71fbde3c4e49463c19","modified":1560749588695},{"_id":"themes/hu/source/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1560749588696},{"_id":"themes/hu/source/css/toc.styl","hash":"631e97f634d30f53314e2fec8bdde267c1c49f4c","modified":1560749588697},{"_id":"themes/hu/source/css/signature.styl","hash":"88159b31c59d59c01a0b534af57242662a2a3969","modified":1560749588696},{"_id":"themes/hu/source/css/widget.styl","hash":"7a9f735f5ef323dc2950fbd9d76daa16c9a0f1a9","modified":1560749588697},{"_id":"themes/hu/source/css/rocket.styl","hash":"e15c51c8566ecd943112e57592888dd318b6fa6a","modified":1560749588696},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1560749588697},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1560749588698},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1560749588699},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1560749588699},{"_id":"themes/hu/source/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1560749588700},{"_id":"themes/hu/source/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1560749588700},{"_id":"themes/hu/source/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1560749588700},{"_id":"themes/hu/source/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1560749588702},{"_id":"themes/hu/source/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1560749588702},{"_id":"themes/hu/source/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1560749588703},{"_id":"themes/hu/source/js/toc.js","hash":"41e52551731854224c249d53010c1bae5aa92ffa","modified":1560749588702},{"_id":"themes/hu/source/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1560749588695},{"_id":"themes/hu/source/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1560749588698},{"_id":"themes/hu/source/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1560749588699},{"_id":"themes/hu/source/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1560749588702},{"_id":"source/img/header_img/about.jpg","hash":"62a9a76854503c327990cc8d10de293ab6e9588f","modified":1560749588641},{"_id":"source/img/header_img/archive.jpg","hash":"990f6f9dd0ecb5348bfcc47305553d58c0d8f326","modified":1560749588643},{"_id":"source/img/header_img/archives-widget.jpg","hash":"68f7d525269a94287e0ad18713ae232fb59dcf71","modified":1560749588646},{"_id":"source/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1560749588686},{"_id":"themes/hu/source/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1560749588694},{"_id":"themes/hu/source/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1560749588696},{"_id":"themes/hu/source/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1560749588696},{"_id":"source/img/avatar/ironman.png","hash":"7d6a06b4b544ab146c3b3e8474edc33f14ac6e4d","modified":1560749588617},{"_id":"source/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1560749588684},{"_id":"themes/hu/source/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1560749588701},{"_id":"source/img/article_header/article_bg.jpg","hash":"6af63305c923899017e727b5ca968a2703bc08cf","modified":1560749588608},{"_id":"source/img/article/huweihuang_blog.png","hash":"392cf8b33be6c752dd908e027fa3346a6ecd58ab","modified":1560749588605},{"_id":"source/img/blog.jpg","hash":"a76af0b98dbe92ca2d21babcef13f094e409554b","modified":1560749588621},{"_id":"source/img/header_img/home.jpg","hash":"8f1c440427a4aa86b623503a926c027e2e10cd66","modified":1560749588660},{"_id":"source/img/header_img/tag.png","hash":"e83cd7b04ff85bcbc9bd3ebf5e57a55166e82568","modified":1560749588681},{"_id":"source/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1560749588612},{"_id":"source/img/header_img/home-bg-o.png","hash":"134ece4cb4c49c7ca1403a5afe7f46d0e2f9ecbb","modified":1560749588657},{"_id":"source/img/header_img/home2.png","hash":"da6a3d5ca787bdc25e69655abd879b4f821aeb30","modified":1560749588673},{"_id":"source/img/header_img/404.png","hash":"6bf9c224543ec54e250309db89cbdf46e0c4b5ba","modified":1560749588637},{"_id":"public/post-sitemap.xml","hash":"57d008d59d10c77e0a64a02dfc42d2e31bb2fa3a","modified":1560953840026},{"_id":"public/page-sitemap.xml","hash":"83b8dd88f97f8a5865a3af456fc4c9b31b0e245f","modified":1560953840026},{"_id":"public/tag-sitemap.xml","hash":"9800892568aed303202d01c15f2cac5fc23ba526","modified":1560953840174},{"_id":"public/sitemap.xsl","hash":"4321fa69dc1b8811d32b7a1478e5603e038cea1a","modified":1560953840174},{"_id":"public/sitemap.xml","hash":"53c34e3b906f2866195840beb9e9c1eedd55b32f","modified":1560953840220},{"_id":"public/404.html","hash":"65713d36d462bc378eb17c066ec6e04b1fe2af74","modified":1560953840227},{"_id":"public/2019/06/15/序/index.html","hash":"85a6a13ba014974af89020c19d85ce64380dfdfc","modified":1560953840227},{"_id":"public/about/index.html","hash":"1f2f9120872a44c02cae696b06de7ac2e7949733","modified":1560953840227},{"_id":"public/tags/index.html","hash":"6b8de7aad2ef02ae367dc7d35dc56fe431952528","modified":1560953840227},{"_id":"public/2019/06/19/docker基本使用/index.html","hash":"6f3f80fcdf0a6bbdd6f5eecdc6725425527b991d","modified":1560953840227},{"_id":"public/2019/06/19/python爬虫框架scrapy/index.html","hash":"2c1f69be5cfe6c0b47a33d4771aeaec8f9ee856d","modified":1560953840228},{"_id":"public/2019/06/19/分享个人vscode常用插件/index.html","hash":"fd4fe6c04fd45bf1cf811b9e8381b6e1b90dcbf9","modified":1560953840228},{"_id":"public/2019/06/19/nginx入门/index.html","hash":"cd5dc7726081b8d3e25308ff5f4695cf482d3b1b","modified":1560953840228},{"_id":"public/2019/06/16/利用verdaccio搭建私有npm仓库/index.html","hash":"8ffa1d89bfe04c1290ce830b9180cefdefecef30","modified":1560953840228},{"_id":"public/archive/index.html","hash":"3dbf521df18a0a94a2cc04ff74e368d06163adbd","modified":1560953840228},{"_id":"public/archives/index.html","hash":"e684429ffaa8e5fa112dda6203b09eac4c910f4c","modified":1560953840228},{"_id":"public/archives/2019/index.html","hash":"8cd8108b1124df556dfccda5f3eff15e7ee66423","modified":1560953840228},{"_id":"public/archives/2019/06/index.html","hash":"94461ad3db4ec1ef13ed80f6f64bb5fc9b750256","modified":1560953840228},{"_id":"public/tags/python/index.html","hash":"227b752dd1f5a7ef8b8eabb60c6e4e53884ae4ea","modified":1560953840228},{"_id":"public/tags/docker/index.html","hash":"f7d598f0881e48cf27d8f87b9bbebd0fd127b3e9","modified":1560953840228},{"_id":"public/tags/tool/index.html","hash":"89774a8d351cc1e44c48de4a88673088457a0314","modified":1560953840228},{"_id":"public/tags/node/index.html","hash":"a527d4dd1993d8dc377b01d4ff96b603751eef20","modified":1560953840228},{"_id":"public/tags/随笔/index.html","hash":"774561bfebefe44153e8847c9b6a05eda9276664","modified":1560953840228},{"_id":"public/tags/nginx/index.html","hash":"4fe6d4894ba0c03ad3222be16654da498d324d89","modified":1560953840228},{"_id":"public/index.html","hash":"0653d9d0da0d49f6f938481a9ce3d91c24a45775","modified":1560953840228},{"_id":"public/CNAME","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1560953840229},{"_id":"public/img/article/tag.png","hash":"c8632d64d9471009098b84f70273e63037a4e7b8","modified":1560953840233},{"_id":"public/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1560953840233},{"_id":"public/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1560953840233},{"_id":"public/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1560953840233},{"_id":"public/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1560953840233},{"_id":"public/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1560953840233},{"_id":"public/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1560953840234},{"_id":"public/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1560953840234},{"_id":"public/img/header_img/about.jpg","hash":"62a9a76854503c327990cc8d10de293ab6e9588f","modified":1560953840496},{"_id":"public/css/donate.css","hash":"f65ac8363d8d215adb896158e7b45165db259a47","modified":1560953840503},{"_id":"public/css/archive.css","hash":"8db895ebaeff19ac145c961abcfd5d4a8d67a8ea","modified":1560953840503},{"_id":"public/css/highlight.css","hash":"c58b4569c086e477a00dcbf5a95a166fe5fecfb0","modified":1560953840504},{"_id":"public/css/widget.css","hash":"da95ad3f1938f24d20f1fa77d7a38f0c392b5ec8","modified":1560953840504},{"_id":"public/css/toc.css","hash":"f756b9e1b2208d2e5b0f3d2ac5e4fea3b7da0e10","modified":1560953840504},{"_id":"public/css/signature.css","hash":"820fa4743cea34a61808cd8f7de528605c32d7e3","modified":1560953840505},{"_id":"public/css/rocket.css","hash":"9456fd92f729e09d6de8cda70f95d78e0d789c70","modified":1560953840505},{"_id":"public/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1560953840505},{"_id":"public/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1560953840505},{"_id":"public/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1560953840506},{"_id":"public/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1560953840506},{"_id":"public/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1560953840506},{"_id":"public/js/toc.js","hash":"41e52551731854224c249d53010c1bae5aa92ffa","modified":1560953840506},{"_id":"public/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1560953840506},{"_id":"public/img/header_img/archive.jpg","hash":"990f6f9dd0ecb5348bfcc47305553d58c0d8f326","modified":1560953840506},{"_id":"public/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1560953840506},{"_id":"public/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1560953840510},{"_id":"public/css/beantech.css","hash":"4c361354fd8e9851923fb21a620bc079380ebcd8","modified":1560953840515},{"_id":"public/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1560953840515},{"_id":"public/css/beantech.min.css","hash":"05a06230b1a9eca0b30cece54a397008cb77dc50","modified":1560953840515},{"_id":"public/img/avatar/ironman.png","hash":"7d6a06b4b544ab146c3b3e8474edc33f14ac6e4d","modified":1560953840515},{"_id":"public/img/header_img/archives-widget.jpg","hash":"68f7d525269a94287e0ad18713ae232fb59dcf71","modified":1560953840521},{"_id":"public/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1560953840525},{"_id":"public/img/article_header/article_bg.jpg","hash":"6af63305c923899017e727b5ca968a2703bc08cf","modified":1560953840525},{"_id":"public/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1560953840571},{"_id":"public/img/article/huweihuang_blog.png","hash":"392cf8b33be6c752dd908e027fa3346a6ecd58ab","modified":1560953840571},{"_id":"public/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1560953840573},{"_id":"public/img/header_img/home.jpg","hash":"8f1c440427a4aa86b623503a926c027e2e10cd66","modified":1560953840577},{"_id":"public/img/blog.jpg","hash":"a76af0b98dbe92ca2d21babcef13f094e409554b","modified":1560953840582},{"_id":"public/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1560953840591},{"_id":"public/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1560953840599},{"_id":"public/img/header_img/tag.png","hash":"e83cd7b04ff85bcbc9bd3ebf5e57a55166e82568","modified":1560953840604},{"_id":"public/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1560953840615},{"_id":"public/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1560953840618},{"_id":"public/img/header_img/home-bg-o.png","hash":"134ece4cb4c49c7ca1403a5afe7f46d0e2f9ecbb","modified":1560953840619},{"_id":"public/img/header_img/home2.png","hash":"da6a3d5ca787bdc25e69655abd879b4f821aeb30","modified":1560953840624},{"_id":"public/img/header_img/404.png","hash":"6bf9c224543ec54e250309db89cbdf46e0c4b5ba","modified":1560953840635}],"Category":[],"Data":[],"Page":[{"layout":"404","description":"你来到了没有知识的荒原","header-img":"/img/header_img/404.png","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"你来到了没有知识的荒原\"\nheader-img: \"/img/header_img/404.png\"\n---\n","date":"2019-06-17T05:45:34.310Z","updated":"2019-06-17T05:33:08.590Z","path":"404.html","title":"","comments":1,"_id":"cjx3bm2y90000bi1p498aavah","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"about","title":"About","date":"2017-10-03T02:48:33.000Z","description":"走在成为极客的路上","header-img":"/blog/img/header_img/about.jpg","aplayer":true,"fixed":false,"_content":"\n### 一句话\n\n>Just do it !    (翻译：nike名言)\n\n### 关于我\n\n>\n>\n>\n\n### 兴趣方向\n\n>\n\n### 参与社区\n\n > 掘金: \n >\n\n### 联系我\n\n>Email: hc1132107224@163.com\n","source":"about/index.md","raw":"---\nlayout: \"about\"\ntitle: \"About\"\ndate: 2017-10-03 10:48:33\ndescription: \"走在成为极客的路上\"\nheader-img: \"/blog/img/header_img/about.jpg\"\naplayer: true\nfixed: false\n---\n\n### 一句话\n\n>Just do it !    (翻译：nike名言)\n\n### 关于我\n\n>\n>\n>\n\n### 兴趣方向\n\n>\n\n### 参与社区\n\n > 掘金: \n >\n\n### 联系我\n\n>Email: hc1132107224@163.com\n","updated":"2019-06-17T14:05:30.081Z","path":"about/index.html","comments":1,"_id":"cjx3bm2yr0002bi1prt90twz9","content":"<h3><span id=\"一句话\">一句话</span></h3>\n<blockquote>\n<p>Just do it !    (翻译：nike名言)</p>\n</blockquote>\n<h3><span id=\"关于我\">关于我</span></h3>\n<blockquote></blockquote>\n<h3><span id=\"兴趣方向\">兴趣方向</span></h3>\n<blockquote></blockquote>\n<h3><span id=\"参与社区\">参与社区</span></h3>\n<blockquote>\n<p>掘金:</p>\n</blockquote>\n<h3><span id=\"联系我\">联系我</span></h3>\n<blockquote>\n<p>Email: <a href=\"mailto:hc1132107224@163.com\" target=\"_blank\" rel=\"noopener\">hc1132107224@163.com</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3>一句话</h3>\n<blockquote>\n<p>Just do it !    (翻译：nike名言)</p>\n</blockquote>\n<h3>关于我</h3>\n<blockquote></blockquote>\n<h3>兴趣方向</h3>\n<blockquote></blockquote>\n<h3>参与社区</h3>\n<blockquote>\n<p>掘金:</p>\n</blockquote>\n<h3>联系我</h3>\n<blockquote>\n<p>Email: <a href=\"mailto:hc1132107224@163.com\" target=\"_blank\" rel=\"noopener\">hc1132107224@163.com</a></p>\n</blockquote>\n"},{"layout":"archive","title":"Archives","header-img":"/blog/img/header_img/archive.jpg","comments":0,"date":"2017-09-20T12:49:56.000Z","description":"Hey, this is archives","_content":"","source":"archive/index.md","raw":"---\nlayout: \"archive\"\ntitle: \"Archives\"\nheader-img: \"/blog/img/header_img/archive.jpg\"\ncomments: false\ndate: 2017-09-20 20:49:56\ndescription: \"Hey, this is archives\"\n---\n","updated":"2019-06-17T14:10:27.584Z","path":"archive/index.html","_id":"cjx3bm2yt0004bi1pvrmx1x2u","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"tags","title":"Tags","description":"Hey, this is Tags.","header-img":"/blog/img/header_img/tag.png","_content":"","source":"tags/index.md","raw":"---\nlayout: \"tags\"\ntitle: \"Tags\"\ndescription: \"Hey, this is Tags.\"\nheader-img: \"/blog/img/header_img/tag.png\"\n---\n","date":"2019-06-17T14:10:01.149Z","updated":"2019-06-17T14:10:01.149Z","path":"tags/index.html","comments":1,"_id":"cjx3bm2yx0007bi1pc2s1p3no","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"python爬虫框架scrapy","catalog":true,"date":"2019-06-19T06:07:34.000Z","subtitle":null,"header-img":null,"_content":"### 基本用法\n\n1.创建项目\n\n```shell\nscrapy startproject 项目名称\n```\n\n2.创建一个爬虫\n\n```shell\nscrapy genspider XX XX.com\n```\n\n3.启动脚本\n\n``` shell\nscrapy crawl XX\n```\n\n4.爬虫脚本\n\n 必须要有`name`和`parse`以及`start_urls`方法，`allowed_domains`可选\n\n```python\n# -*- coding: utf-8 -*-\nimport scrapy\n\nclass BaiduSpider(scrapy.Spider):\n    name = 'baidu'\n    allowed_domains = ['baidu.com']\n    start_urls = ['https://www.baidu.com/']\n\n    def parse(self, response):\n        print(response.text)\n```\n\n其中 start_urls可以接受多个url参数，也可以拆分成多个步骤\n\n```python\n# -*- coding: utf-8 -*-\nimport scrapy\n\nclass BaiduSpider(scrapy.Spider):\n    name = 'baidu'\n    allowed_domains = ['baidu.com']\n    # start_urls = ['https://www.baidu.com/']\n\n    def start_requests(self):\n        yield scrapy.Request('https://www.baidu.com')\n\n    def parse(self, response):\n        print(response.text)\n```\n\n---\n\n1.`Items`相当于定义的需要输出的数据结构；\n\n`item`传参是爬虫脚本的`parse`方法`yield`过来的对象\n\n---\n\n## Pipline\n\n### 1. 介绍\n\n  当item在Spider中被收集之后，会传递到item pipline中处理；\n\n  作用：\n\n- 清理html数据\n- 验证爬取数据\n- 去重并丢弃\n- 数据持久化\n\n### 2. 编写item pipline\n  \n2.1 必须实现的函数\n\n- process_item\n\n  每个`pipline`都是一个python类，负责接收到`item`并执行一些行为，内部必须实现`process_item(self, item, spider)`方法，必须返回一个`dict`或者`item`对象。\n\n  `piplines`只能接受字典和`items`，在主程序的`parse`方法通过`yield`推送到`piplines`\n\n2.2可以选择实现\n\n- `open_spider(self, spider)`表示当spider开启的时候调用的方法；\n- `close_spider(self, spider)`标识当spider关闭的时候调用的方法；\n  \n注意：\n\n- `pipline`写完需要在配置项`settings`的`ITEM_PIPELINES`里写入来启动\n\n```python\nITEM_PIPELINE {\n  demo.pipelines.testDemoPipeline : 300    // 300是优先级 越大优先级越高\n}\n```\n\n- 文件流写入是缓冲一定字节的数据再一次性写入\n\n  强制立刻写入\n\n```python\nself.file.flush()\n```\n\n---\n","source":"_posts/python爬虫框架scrapy.md","raw":"---\ntitle: python爬虫框架scrapy\ncatalog: true\ndate: 2019-06-19 14:07:34\nsubtitle:\nheader-img:\ntags: python\n---\n### 基本用法\n\n1.创建项目\n\n```shell\nscrapy startproject 项目名称\n```\n\n2.创建一个爬虫\n\n```shell\nscrapy genspider XX XX.com\n```\n\n3.启动脚本\n\n``` shell\nscrapy crawl XX\n```\n\n4.爬虫脚本\n\n 必须要有`name`和`parse`以及`start_urls`方法，`allowed_domains`可选\n\n```python\n# -*- coding: utf-8 -*-\nimport scrapy\n\nclass BaiduSpider(scrapy.Spider):\n    name = 'baidu'\n    allowed_domains = ['baidu.com']\n    start_urls = ['https://www.baidu.com/']\n\n    def parse(self, response):\n        print(response.text)\n```\n\n其中 start_urls可以接受多个url参数，也可以拆分成多个步骤\n\n```python\n# -*- coding: utf-8 -*-\nimport scrapy\n\nclass BaiduSpider(scrapy.Spider):\n    name = 'baidu'\n    allowed_domains = ['baidu.com']\n    # start_urls = ['https://www.baidu.com/']\n\n    def start_requests(self):\n        yield scrapy.Request('https://www.baidu.com')\n\n    def parse(self, response):\n        print(response.text)\n```\n\n---\n\n1.`Items`相当于定义的需要输出的数据结构；\n\n`item`传参是爬虫脚本的`parse`方法`yield`过来的对象\n\n---\n\n## Pipline\n\n### 1. 介绍\n\n  当item在Spider中被收集之后，会传递到item pipline中处理；\n\n  作用：\n\n- 清理html数据\n- 验证爬取数据\n- 去重并丢弃\n- 数据持久化\n\n### 2. 编写item pipline\n  \n2.1 必须实现的函数\n\n- process_item\n\n  每个`pipline`都是一个python类，负责接收到`item`并执行一些行为，内部必须实现`process_item(self, item, spider)`方法，必须返回一个`dict`或者`item`对象。\n\n  `piplines`只能接受字典和`items`，在主程序的`parse`方法通过`yield`推送到`piplines`\n\n2.2可以选择实现\n\n- `open_spider(self, spider)`表示当spider开启的时候调用的方法；\n- `close_spider(self, spider)`标识当spider关闭的时候调用的方法；\n  \n注意：\n\n- `pipline`写完需要在配置项`settings`的`ITEM_PIPELINES`里写入来启动\n\n```python\nITEM_PIPELINE {\n  demo.pipelines.testDemoPipeline : 300    // 300是优先级 越大优先级越高\n}\n```\n\n- 文件流写入是缓冲一定字节的数据再一次性写入\n\n  强制立刻写入\n\n```python\nself.file.flush()\n```\n\n---\n","slug":"python爬虫框架scrapy","published":1,"updated":"2019-06-19T06:12:56.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2yo0001bi1psucuvo9m","content":"<h3><span id=\"基本用法\">基本用法</span></h3>\n<p>1.创建项目</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy startproject 项目名称</span><br></pre></td></tr></table></figure>\n<p>2.创建一个爬虫</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy genspider XX XX.com</span><br></pre></td></tr></table></figure>\n<p>3.启动脚本</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy crawl XX</span><br></pre></td></tr></table></figure>\n<p>4.爬虫脚本</p>\n<p>必须要有<code>name</code>和<code>parse</code>以及<code>start_urls</code>方法，<code>allowed_domains</code>可选</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaiduSpider</span><span class=\"params\">(scrapy.Spider)</span>:</span></span><br><span class=\"line\">    name = <span class=\"string\">'baidu'</span></span><br><span class=\"line\">    allowed_domains = [<span class=\"string\">'baidu.com'</span>]</span><br><span class=\"line\">    start_urls = [<span class=\"string\">'https://www.baidu.com/'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse</span><span class=\"params\">(self, response)</span>:</span></span><br><span class=\"line\">        print(response.text)</span><br></pre></td></tr></table></figure>\n<p>其中 start_urls可以接受多个url参数，也可以拆分成多个步骤</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaiduSpider</span><span class=\"params\">(scrapy.Spider)</span>:</span></span><br><span class=\"line\">    name = <span class=\"string\">'baidu'</span></span><br><span class=\"line\">    allowed_domains = [<span class=\"string\">'baidu.com'</span>]</span><br><span class=\"line\">    <span class=\"comment\"># start_urls = ['https://www.baidu.com/']</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">start_requests</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">yield</span> scrapy.Request(<span class=\"string\">'https://www.baidu.com'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse</span><span class=\"params\">(self, response)</span>:</span></span><br><span class=\"line\">        print(response.text)</span><br></pre></td></tr></table></figure>\n<hr>\n<p>1.<code>Items</code>相当于定义的需要输出的数据结构；</p>\n<p><code>item</code>传参是爬虫脚本的<code>parse</code>方法<code>yield</code>过来的对象</p>\n<hr>\n<h2><span id=\"pipline\">Pipline</span></h2>\n<h3><span id=\"1-介绍\">1. 介绍</span></h3>\n<p>当item在Spider中被收集之后，会传递到item pipline中处理；</p>\n<p>作用：</p>\n<ul>\n<li>清理html数据</li>\n<li>验证爬取数据</li>\n<li>去重并丢弃</li>\n<li>数据持久化</li>\n</ul>\n<h3><span id=\"2-编写item-pipline\">2. 编写item pipline</span></h3>\n<p>2.1 必须实现的函数</p>\n<ul>\n<li>\n<p>process_item</p>\n<p>每个<code>pipline</code>都是一个python类，负责接收到<code>item</code>并执行一些行为，内部必须实现<code>process_item(self, item, spider)</code>方法，必须返回一个<code>dict</code>或者<code>item</code>对象。</p>\n<p><code>piplines</code>只能接受字典和<code>items</code>，在主程序的<code>parse</code>方法通过<code>yield</code>推送到<code>piplines</code></p>\n</li>\n</ul>\n<p>2.2可以选择实现</p>\n<ul>\n<li><code>open_spider(self, spider)</code>表示当spider开启的时候调用的方法；</li>\n<li><code>close_spider(self, spider)</code>标识当spider关闭的时候调用的方法；</li>\n</ul>\n<p>注意：</p>\n<ul>\n<li><code>pipline</code>写完需要在配置项<code>settings</code>的<code>ITEM_PIPELINES</code>里写入来启动</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ITEM_PIPELINE &#123;</span><br><span class=\"line\">  demo.pipelines.testDemoPipeline : <span class=\"number\">300</span>    // <span class=\"number\">300</span>是优先级 越大优先级越高</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>文件流写入是缓冲一定字节的数据再一次性写入</p>\n<p>强制立刻写入</p>\n</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.file.flush()</span><br></pre></td></tr></table></figure>\n<hr>\n","site":{"data":{}},"excerpt":"","more":"<h3>基本用法</h3>\n<p>1.创建项目</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy startproject 项目名称</span><br></pre></td></tr></table></figure>\n<p>2.创建一个爬虫</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy genspider XX XX.com</span><br></pre></td></tr></table></figure>\n<p>3.启动脚本</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scrapy crawl XX</span><br></pre></td></tr></table></figure>\n<p>4.爬虫脚本</p>\n<p>必须要有<code>name</code>和<code>parse</code>以及<code>start_urls</code>方法，<code>allowed_domains</code>可选</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaiduSpider</span><span class=\"params\">(scrapy.Spider)</span>:</span></span><br><span class=\"line\">    name = <span class=\"string\">'baidu'</span></span><br><span class=\"line\">    allowed_domains = [<span class=\"string\">'baidu.com'</span>]</span><br><span class=\"line\">    start_urls = [<span class=\"string\">'https://www.baidu.com/'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse</span><span class=\"params\">(self, response)</span>:</span></span><br><span class=\"line\">        print(response.text)</span><br></pre></td></tr></table></figure>\n<p>其中 start_urls可以接受多个url参数，也可以拆分成多个步骤</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaiduSpider</span><span class=\"params\">(scrapy.Spider)</span>:</span></span><br><span class=\"line\">    name = <span class=\"string\">'baidu'</span></span><br><span class=\"line\">    allowed_domains = [<span class=\"string\">'baidu.com'</span>]</span><br><span class=\"line\">    <span class=\"comment\"># start_urls = ['https://www.baidu.com/']</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">start_requests</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">yield</span> scrapy.Request(<span class=\"string\">'https://www.baidu.com'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse</span><span class=\"params\">(self, response)</span>:</span></span><br><span class=\"line\">        print(response.text)</span><br></pre></td></tr></table></figure>\n<hr>\n<p>1.<code>Items</code>相当于定义的需要输出的数据结构；</p>\n<p><code>item</code>传参是爬虫脚本的<code>parse</code>方法<code>yield</code>过来的对象</p>\n<hr>\n<h2>Pipline</h2>\n<h3>1. 介绍</h3>\n<p>当item在Spider中被收集之后，会传递到item pipline中处理；</p>\n<p>作用：</p>\n<ul>\n<li>清理html数据</li>\n<li>验证爬取数据</li>\n<li>去重并丢弃</li>\n<li>数据持久化</li>\n</ul>\n<h3>2. 编写item pipline</h3>\n<p>2.1 必须实现的函数</p>\n<ul>\n<li>\n<p>process_item</p>\n<p>每个<code>pipline</code>都是一个python类，负责接收到<code>item</code>并执行一些行为，内部必须实现<code>process_item(self, item, spider)</code>方法，必须返回一个<code>dict</code>或者<code>item</code>对象。</p>\n<p><code>piplines</code>只能接受字典和<code>items</code>，在主程序的<code>parse</code>方法通过<code>yield</code>推送到<code>piplines</code></p>\n</li>\n</ul>\n<p>2.2可以选择实现</p>\n<ul>\n<li><code>open_spider(self, spider)</code>表示当spider开启的时候调用的方法；</li>\n<li><code>close_spider(self, spider)</code>标识当spider关闭的时候调用的方法；</li>\n</ul>\n<p>注意：</p>\n<ul>\n<li><code>pipline</code>写完需要在配置项<code>settings</code>的<code>ITEM_PIPELINES</code>里写入来启动</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ITEM_PIPELINE &#123;</span><br><span class=\"line\">  demo.pipelines.testDemoPipeline : <span class=\"number\">300</span>    // <span class=\"number\">300</span>是优先级 越大优先级越高</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>文件流写入是缓冲一定字节的数据再一次性写入</p>\n<p>强制立刻写入</p>\n</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.file.flush()</span><br></pre></td></tr></table></figure>\n<hr>\n"},{"title":"docker基本使用","catalog":true,"date":"2019-06-19T06:15:03.000Z","subtitle":null,"header-img":null,"_content":"本文都是基于`centos7`环境使用\n\n1. 启动docker\n\n启动配置文件默认`/etc/docker/daemon.json`\n可以修改配置文件指定docker服务启动的一些默认参数\n\n- --regisrty-mirror=PROXY_URL 指定拉取镜像的地址加速Docker镜像拉取\n\n2.docker pull NAME[:TAG]\n      默认都是从 `docker`官方仓库去拉取镜像（registry.hub.docker.com）\n 一般直接pull  \n比如：\n`docker`下载`node`的`alpine`版本\n\n```shell\ndocker pull node:10.15-alpine\n```\n\n相当于\n\n```shell\ndocker pull registry.hub.docker.com/ubuntu:node:10.15-alpine\n```\n\n`alpine`是`node`在`docker`运行的最小环境的版本，相比于完整的`node`包体积更小\n\n如果不指定版本默认拉取 `latest`版本，生产环境的时候最好指定版本号，因为`lastest`版本会跟踪最新版本的变更而变化\n\n3.如何进入`未启动`的`node`镜像内部去修改默认一些配置\n\n```shell\ndocker run -it node:10.15-alpine sh\n```\n\n以`shell`脚本的方式去执行`node`命令\n\n4.docker exec  ／ docker attach\n\n两者都是进入容器内部\n\n`attach`的不足：\n\n- 多个窗口同时 `attach`同一个容器时候，所有窗口会同步显示；\n- 当某个窗口因命令阻塞，所有窗口都无法执行操作；\n\n进入`已成功运行`的容器内部\n\n```shell\ndocker exec -it 容器名称/容器ID /bin/sh\n```\n\n- -i 支持标准输入\n- -t 开启一个伪终端\n\n5.docker ps\n\n- docker ps\n查看已经成功运行的容器（如果运行容器之后ps未看到说明容器启动失败）\n- docker ps  -a\n    查看所有容器（包含未成功运行的容器）\n- docker ps -f 容器id  \n    根据容器id筛选指定容器\n\n6.docker run\n\n参数部分\n\n- -d  守护进程方式运行\n- -p 端口映射 （外部访问的端口：docker内部端口）\n- -u 指定容器的用户\n- -v 挂载存储卷映射 （外部存储卷位置：docker内部存储卷位置）\n- -h 指定容器的主机名\n- -root\n- --name 容器重命名\n- --rm  容器停止后自动删除\n- --link 关联其它容器\n  \n","source":"_posts/docker基本使用.md","raw":"---\ntitle: docker基本使用\ncatalog: true\ndate: 2019-06-19 14:15:03\nsubtitle:\nheader-img:\ntags: docker\n---\n本文都是基于`centos7`环境使用\n\n1. 启动docker\n\n启动配置文件默认`/etc/docker/daemon.json`\n可以修改配置文件指定docker服务启动的一些默认参数\n\n- --regisrty-mirror=PROXY_URL 指定拉取镜像的地址加速Docker镜像拉取\n\n2.docker pull NAME[:TAG]\n      默认都是从 `docker`官方仓库去拉取镜像（registry.hub.docker.com）\n 一般直接pull  \n比如：\n`docker`下载`node`的`alpine`版本\n\n```shell\ndocker pull node:10.15-alpine\n```\n\n相当于\n\n```shell\ndocker pull registry.hub.docker.com/ubuntu:node:10.15-alpine\n```\n\n`alpine`是`node`在`docker`运行的最小环境的版本，相比于完整的`node`包体积更小\n\n如果不指定版本默认拉取 `latest`版本，生产环境的时候最好指定版本号，因为`lastest`版本会跟踪最新版本的变更而变化\n\n3.如何进入`未启动`的`node`镜像内部去修改默认一些配置\n\n```shell\ndocker run -it node:10.15-alpine sh\n```\n\n以`shell`脚本的方式去执行`node`命令\n\n4.docker exec  ／ docker attach\n\n两者都是进入容器内部\n\n`attach`的不足：\n\n- 多个窗口同时 `attach`同一个容器时候，所有窗口会同步显示；\n- 当某个窗口因命令阻塞，所有窗口都无法执行操作；\n\n进入`已成功运行`的容器内部\n\n```shell\ndocker exec -it 容器名称/容器ID /bin/sh\n```\n\n- -i 支持标准输入\n- -t 开启一个伪终端\n\n5.docker ps\n\n- docker ps\n查看已经成功运行的容器（如果运行容器之后ps未看到说明容器启动失败）\n- docker ps  -a\n    查看所有容器（包含未成功运行的容器）\n- docker ps -f 容器id  \n    根据容器id筛选指定容器\n\n6.docker run\n\n参数部分\n\n- -d  守护进程方式运行\n- -p 端口映射 （外部访问的端口：docker内部端口）\n- -u 指定容器的用户\n- -v 挂载存储卷映射 （外部存储卷位置：docker内部存储卷位置）\n- -h 指定容器的主机名\n- -root\n- --name 容器重命名\n- --rm  容器停止后自动删除\n- --link 关联其它容器\n  \n","slug":"docker基本使用","published":1,"updated":"2019-06-19T06:18:45.733Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2ys0003bi1p06cy5trz","content":"<p>本文都是基于<code>centos7</code>环境使用</p>\n<ol>\n<li>启动docker</li>\n</ol>\n<p>启动配置文件默认<code>/etc/docker/daemon.json</code><br>\n可以修改配置文件指定docker服务启动的一些默认参数</p>\n<ul>\n<li>–regisrty-mirror=PROXY_URL 指定拉取镜像的地址加速Docker镜像拉取</li>\n</ul>\n<p>2.docker pull NAME[:TAG]<br>\n默认都是从 <code>docker</code>官方仓库去拉取镜像（<a href=\"http://registry.hub.docker.com\" target=\"_blank\" rel=\"noopener\">registry.hub.docker.com</a>）<br>\n一般直接pull<br>\n比如：<br>\n<code>docker</code>下载<code>node</code>的<code>alpine</code>版本</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull node:10.15-alpine</span><br></pre></td></tr></table></figure>\n<p>相当于</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull registry.hub.docker.com/ubuntu:node:10.15-alpine</span><br></pre></td></tr></table></figure>\n<p><code>alpine</code>是<code>node</code>在<code>docker</code>运行的最小环境的版本，相比于完整的<code>node</code>包体积更小</p>\n<p>如果不指定版本默认拉取 <code>latest</code>版本，生产环境的时候最好指定版本号，因为<code>lastest</code>版本会跟踪最新版本的变更而变化</p>\n<p>3.如何进入<code>未启动</code>的<code>node</code>镜像内部去修改默认一些配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -it node:10.15-alpine sh</span><br></pre></td></tr></table></figure>\n<p>以<code>shell</code>脚本的方式去执行<code>node</code>命令</p>\n<p>4.docker exec  ／ docker attach</p>\n<p>两者都是进入容器内部</p>\n<p><code>attach</code>的不足：</p>\n<ul>\n<li>多个窗口同时 <code>attach</code>同一个容器时候，所有窗口会同步显示；</li>\n<li>当某个窗口因命令阻塞，所有窗口都无法执行操作；</li>\n</ul>\n<p>进入<code>已成功运行</code>的容器内部</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it 容器名称/容器ID /bin/sh</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-i 支持标准输入</li>\n<li>-t 开启一个伪终端</li>\n</ul>\n<p>5.docker ps</p>\n<ul>\n<li>docker ps<br>\n查看已经成功运行的容器（如果运行容器之后ps未看到说明容器启动失败）</li>\n<li>docker ps  -a<br>\n查看所有容器（包含未成功运行的容器）</li>\n<li>docker ps -f 容器id<br>\n根据容器id筛选指定容器</li>\n</ul>\n<p>6.docker run</p>\n<p>参数部分</p>\n<ul>\n<li>-d  守护进程方式运行</li>\n<li>-p 端口映射 （外部访问的端口：docker内部端口）</li>\n<li>-u 指定容器的用户</li>\n<li>-v 挂载存储卷映射 （外部存储卷位置：docker内部存储卷位置）</li>\n<li>-h 指定容器的主机名</li>\n<li>-root</li>\n<li>–name 容器重命名</li>\n<li>–rm  容器停止后自动删除</li>\n<li>–link 关联其它容器</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>本文都是基于<code>centos7</code>环境使用</p>\n<ol>\n<li>启动docker</li>\n</ol>\n<p>启动配置文件默认<code>/etc/docker/daemon.json</code><br>\n可以修改配置文件指定docker服务启动的一些默认参数</p>\n<ul>\n<li>–regisrty-mirror=PROXY_URL 指定拉取镜像的地址加速Docker镜像拉取</li>\n</ul>\n<p>2.docker pull NAME[:TAG]<br>\n默认都是从 <code>docker</code>官方仓库去拉取镜像（<a href=\"http://registry.hub.docker.com\" target=\"_blank\" rel=\"noopener\">registry.hub.docker.com</a>）<br>\n一般直接pull<br>\n比如：<br>\n<code>docker</code>下载<code>node</code>的<code>alpine</code>版本</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull node:10.15-alpine</span><br></pre></td></tr></table></figure>\n<p>相当于</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull registry.hub.docker.com/ubuntu:node:10.15-alpine</span><br></pre></td></tr></table></figure>\n<p><code>alpine</code>是<code>node</code>在<code>docker</code>运行的最小环境的版本，相比于完整的<code>node</code>包体积更小</p>\n<p>如果不指定版本默认拉取 <code>latest</code>版本，生产环境的时候最好指定版本号，因为<code>lastest</code>版本会跟踪最新版本的变更而变化</p>\n<p>3.如何进入<code>未启动</code>的<code>node</code>镜像内部去修改默认一些配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -it node:10.15-alpine sh</span><br></pre></td></tr></table></figure>\n<p>以<code>shell</code>脚本的方式去执行<code>node</code>命令</p>\n<p>4.docker exec  ／ docker attach</p>\n<p>两者都是进入容器内部</p>\n<p><code>attach</code>的不足：</p>\n<ul>\n<li>多个窗口同时 <code>attach</code>同一个容器时候，所有窗口会同步显示；</li>\n<li>当某个窗口因命令阻塞，所有窗口都无法执行操作；</li>\n</ul>\n<p>进入<code>已成功运行</code>的容器内部</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it 容器名称/容器ID /bin/sh</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-i 支持标准输入</li>\n<li>-t 开启一个伪终端</li>\n</ul>\n<p>5.docker ps</p>\n<ul>\n<li>docker ps<br>\n查看已经成功运行的容器（如果运行容器之后ps未看到说明容器启动失败）</li>\n<li>docker ps  -a<br>\n查看所有容器（包含未成功运行的容器）</li>\n<li>docker ps -f 容器id<br>\n根据容器id筛选指定容器</li>\n</ul>\n<p>6.docker run</p>\n<p>参数部分</p>\n<ul>\n<li>-d  守护进程方式运行</li>\n<li>-p 端口映射 （外部访问的端口：docker内部端口）</li>\n<li>-u 指定容器的用户</li>\n<li>-v 挂载存储卷映射 （外部存储卷位置：docker内部存储卷位置）</li>\n<li>-h 指定容器的主机名</li>\n<li>-root</li>\n<li>–name 容器重命名</li>\n<li>–rm  容器停止后自动删除</li>\n<li>–link 关联其它容器</li>\n</ul>\n"},{"title":"分享个人vscode常用插件","catalog":true,"date":"2019-06-19T05:39:11.000Z","subtitle":null,"header-img":null,"_content":"\n1. Visual Studio IntelliCode 智能补全\n2. prettier 快速格式化 CMD+Shift+P\n3. Regex Previewer 正则表达式测试\n4. stylelint\n5. vetur # 开发vue，语法补全、提示助手 （必备插件）\n6. vscode-icons # vscode图标显示\n7. 小程序助手\n8. vscode-element-helper\n9. SVG Viewer # 预览SVG\n10. Path Intellisense 路径自动补全\n11. minapp # 小程序开发语法补全、提示助手\n12. markdownlint markdown语法支持和预览\n13. Live Server\n14. koroFileHeader # 函数注释、文件信息\n15. GitLens # git辅助工具\n16. javascript code snippets # js代码提示、补全\n17. Eslint # 代码风格提示\n18. Element UI Snippets\n19. EditorConfig for vs code\n20. Document This\n21. Debugger for Chrome\n22. Color HighLight\n23. CodeIf\n24. Code Runner\n25. Chinese Lanfguage Pack for vs code\n26. Bracket Pair Colorizer 括号以多彩颜色区分\n27. Beautify    # 美化代码\n28. Auto Rename Tag # 自动重命名标签\n29. Auto Close Tag  # 自动闭合标签\n","source":"_posts/分享个人vscode常用插件.md","raw":"---\ntitle: 分享个人vscode常用插件\ncatalog: true\ndate: 2019-06-19 13:39:11\nsubtitle:\nheader-img:\ntags: tool\n---\n\n1. Visual Studio IntelliCode 智能补全\n2. prettier 快速格式化 CMD+Shift+P\n3. Regex Previewer 正则表达式测试\n4. stylelint\n5. vetur # 开发vue，语法补全、提示助手 （必备插件）\n6. vscode-icons # vscode图标显示\n7. 小程序助手\n8. vscode-element-helper\n9. SVG Viewer # 预览SVG\n10. Path Intellisense 路径自动补全\n11. minapp # 小程序开发语法补全、提示助手\n12. markdownlint markdown语法支持和预览\n13. Live Server\n14. koroFileHeader # 函数注释、文件信息\n15. GitLens # git辅助工具\n16. javascript code snippets # js代码提示、补全\n17. Eslint # 代码风格提示\n18. Element UI Snippets\n19. EditorConfig for vs code\n20. Document This\n21. Debugger for Chrome\n22. Color HighLight\n23. CodeIf\n24. Code Runner\n25. Chinese Lanfguage Pack for vs code\n26. Bracket Pair Colorizer 括号以多彩颜色区分\n27. Beautify    # 美化代码\n28. Auto Rename Tag # 自动重命名标签\n29. Auto Close Tag  # 自动闭合标签\n","slug":"分享个人vscode常用插件","published":1,"updated":"2019-06-19T06:00:26.621Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2yw0006bi1p5l4uiys8","content":"<ol>\n<li>Visual Studio IntelliCode 智能补全</li>\n<li>prettier 快速格式化 CMD+Shift+P</li>\n<li>Regex Previewer 正则表达式测试</li>\n<li>stylelint</li>\n<li>vetur # 开发vue，语法补全、提示助手 （必备插件）</li>\n<li>vscode-icons # vscode图标显示</li>\n<li>小程序助手</li>\n<li>vscode-element-helper</li>\n<li>SVG Viewer # 预览SVG</li>\n<li>Path Intellisense 路径自动补全</li>\n<li>minapp # 小程序开发语法补全、提示助手</li>\n<li>markdownlint markdown语法支持和预览</li>\n<li>Live Server</li>\n<li>koroFileHeader # 函数注释、文件信息</li>\n<li>GitLens # git辅助工具</li>\n<li>javascript code snippets # js代码提示、补全</li>\n<li>Eslint # 代码风格提示</li>\n<li>Element UI Snippets</li>\n<li>EditorConfig for vs code</li>\n<li>Document This</li>\n<li>Debugger for Chrome</li>\n<li>Color HighLight</li>\n<li>CodeIf</li>\n<li>Code Runner</li>\n<li>Chinese Lanfguage Pack for vs code</li>\n<li>Bracket Pair Colorizer 括号以多彩颜色区分</li>\n<li>Beautify    # 美化代码</li>\n<li>Auto Rename Tag # 自动重命名标签</li>\n<li>Auto Close Tag  # 自动闭合标签</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li>Visual Studio IntelliCode 智能补全</li>\n<li>prettier 快速格式化 CMD+Shift+P</li>\n<li>Regex Previewer 正则表达式测试</li>\n<li>stylelint</li>\n<li>vetur # 开发vue，语法补全、提示助手 （必备插件）</li>\n<li>vscode-icons # vscode图标显示</li>\n<li>小程序助手</li>\n<li>vscode-element-helper</li>\n<li>SVG Viewer # 预览SVG</li>\n<li>Path Intellisense 路径自动补全</li>\n<li>minapp # 小程序开发语法补全、提示助手</li>\n<li>markdownlint markdown语法支持和预览</li>\n<li>Live Server</li>\n<li>koroFileHeader # 函数注释、文件信息</li>\n<li>GitLens # git辅助工具</li>\n<li>javascript code snippets # js代码提示、补全</li>\n<li>Eslint # 代码风格提示</li>\n<li>Element UI Snippets</li>\n<li>EditorConfig for vs code</li>\n<li>Document This</li>\n<li>Debugger for Chrome</li>\n<li>Color HighLight</li>\n<li>CodeIf</li>\n<li>Code Runner</li>\n<li>Chinese Lanfguage Pack for vs code</li>\n<li>Bracket Pair Colorizer 括号以多彩颜色区分</li>\n<li>Beautify    # 美化代码</li>\n<li>Auto Rename Tag # 自动重命名标签</li>\n<li>Auto Close Tag  # 自动闭合标签</li>\n</ol>\n"},{"title":"利用verdaccio搭建私有npm仓库","catalog":true,"date":"2019-06-16T00:25:18.000Z","subtitle":null,"header-img":null,"_content":"\n随着时间的推移，前端的工程日益庞大，越来越复杂的依赖包需要包管理器来维护。相比搭建没有优势bower仓储，更好的方式是在局域网搭建NPM仓储，维护项目中package.json中的各个插件的版本即可维护项目依赖。\n\n[verdaccio]([https://github.com/verdaccio/verdaccio](https://github.com/verdaccio/verdaccio)\n)是一个部署简易的可以实现github仓储私有化的npm组件，fork于`sinopia`项目，由于`sinopia`项目现在不太维护，存在一些bug，不建议使用。\n\n使用verdaccio的优势\n\n- 配置简单，开箱即用；\n- 不需要数据库,verdaccio内置一个数据库了；\n- 当源为verdaccio时, verdaccio不存在要安装的包时,会自动去设置的远程npm把包缓存到本地；\n\n## 1. 安装verdaccio\n\n```javascript\nnpm i verdaccio -g\n```\n\n## 2. 启动verdaccio\n\n- 默认开启方式\n\n ```shell\nverdaccio\n```\n\n启动成功截图\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-ec7bd2397fb9d6bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n其中`config.yaml`是配置文件，相关配置文件说明如下\n\n```shell\nstorage: ./storage  //npm包存放的路径\n\nauth:\n  htpasswd:\n    file: ./htpasswd   //保存用户的账号密码等信息\n    # Maximum amount of users allowed to register, defaults to \"+inf\".\n    # You can set this to -1 to disable registration.\n    max_users: -1  //默认为1000，改为-1，禁止注册\n\n# a list of other known repositories we can talk to\nuplinks:\n  npmjs:\n    url: http://registry.npm.taobao.org/  //默认为npm的官网，由于国情，改为淘宝源\n\npackages:  //配置权限管理\n  '@*/*':\n    # scoped packages\n    access: $all\n    publish: $authenticated\n\n  '*':\n    # allow all users (including non-authenticated users) to read and\n    # publish all packages\n    #\n    # you can specify usernames/groupnames (depending on your auth plugin)\n    # and three keywords: \"$all\", \"$anonymous\", \"$authenticated\"\n    access: $all  // 所有人都能下载\n\n    # allow all known users to publish packages\n    # (anyone can register by default, remember?)\n    publish: $authenticated // 所有人都有发布包的权限，若想指定默认发布改成对应人的名字\n\n    # if package is not available locally, proxy requests to 'npmjs' registry\n    proxy: npmjs  // 若安装的报在simopia没有，会去配置的npmjs地址去下载\n\n# log settings\nlogs:\n  - {type: stdout, format: pretty, level: http}\n  #- {type: file, path: verdaccio.log, level: info}\n\n# you can specify listen address (or simply a port)\nlisten: 0.0.0.0:4873  // 默认没有，只能在本机访问，添加后可以通过外网访问。\n```\n\n若在服务端部署，需要以守护进程的方式，推荐使用`pm2`去开启\n\n```shell\npm2 start `which verdaccio`\n```\n\npm2启动成功截图\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-dcf94831d7b96096.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n---\n\n## 如何使用\n\n 打开浏览器输入对应的暴露的地址，比如`192.168.0.1:4873`，\n\n截图如下\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-d6ae317646b0afc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n按照截图提示，注册一个用户\n\n```shell\nnpm adduser --registry http://192.168.0.1:4873\n```\n\n安装提示输入账号，密码\n\n## 更改下载源\n\n在每一个客户端中需要更改下载源为verdaccio，这里推荐使用`nrm`，这是一个包下载源管理器。\n\n```shell\nnpm install -g nrm\n\nnrm add verdaccio http://x.x.x.x:4873/\n\nnrm use verdaccio\n```\n\n## 维护\n\n如果需要发布一个包，需要先进行登录\n\n```shell\nnpm login\n```\n\n登录成功之后，在对应的包文件夹下，改好`package.json`版本号，再执行创建发布命令\n\n```shell\nnpm publish\n```\n","source":"_posts/利用verdaccio搭建私有npm仓库.md","raw":"---\ntitle: 利用verdaccio搭建私有npm仓库\ncatalog: true\ndate: 2019-06-16 08:25:18\nsubtitle: \nheader-img:\ntags: node\n---\n\n随着时间的推移，前端的工程日益庞大，越来越复杂的依赖包需要包管理器来维护。相比搭建没有优势bower仓储，更好的方式是在局域网搭建NPM仓储，维护项目中package.json中的各个插件的版本即可维护项目依赖。\n\n[verdaccio]([https://github.com/verdaccio/verdaccio](https://github.com/verdaccio/verdaccio)\n)是一个部署简易的可以实现github仓储私有化的npm组件，fork于`sinopia`项目，由于`sinopia`项目现在不太维护，存在一些bug，不建议使用。\n\n使用verdaccio的优势\n\n- 配置简单，开箱即用；\n- 不需要数据库,verdaccio内置一个数据库了；\n- 当源为verdaccio时, verdaccio不存在要安装的包时,会自动去设置的远程npm把包缓存到本地；\n\n## 1. 安装verdaccio\n\n```javascript\nnpm i verdaccio -g\n```\n\n## 2. 启动verdaccio\n\n- 默认开启方式\n\n ```shell\nverdaccio\n```\n\n启动成功截图\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-ec7bd2397fb9d6bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n其中`config.yaml`是配置文件，相关配置文件说明如下\n\n```shell\nstorage: ./storage  //npm包存放的路径\n\nauth:\n  htpasswd:\n    file: ./htpasswd   //保存用户的账号密码等信息\n    # Maximum amount of users allowed to register, defaults to \"+inf\".\n    # You can set this to -1 to disable registration.\n    max_users: -1  //默认为1000，改为-1，禁止注册\n\n# a list of other known repositories we can talk to\nuplinks:\n  npmjs:\n    url: http://registry.npm.taobao.org/  //默认为npm的官网，由于国情，改为淘宝源\n\npackages:  //配置权限管理\n  '@*/*':\n    # scoped packages\n    access: $all\n    publish: $authenticated\n\n  '*':\n    # allow all users (including non-authenticated users) to read and\n    # publish all packages\n    #\n    # you can specify usernames/groupnames (depending on your auth plugin)\n    # and three keywords: \"$all\", \"$anonymous\", \"$authenticated\"\n    access: $all  // 所有人都能下载\n\n    # allow all known users to publish packages\n    # (anyone can register by default, remember?)\n    publish: $authenticated // 所有人都有发布包的权限，若想指定默认发布改成对应人的名字\n\n    # if package is not available locally, proxy requests to 'npmjs' registry\n    proxy: npmjs  // 若安装的报在simopia没有，会去配置的npmjs地址去下载\n\n# log settings\nlogs:\n  - {type: stdout, format: pretty, level: http}\n  #- {type: file, path: verdaccio.log, level: info}\n\n# you can specify listen address (or simply a port)\nlisten: 0.0.0.0:4873  // 默认没有，只能在本机访问，添加后可以通过外网访问。\n```\n\n若在服务端部署，需要以守护进程的方式，推荐使用`pm2`去开启\n\n```shell\npm2 start `which verdaccio`\n```\n\npm2启动成功截图\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-dcf94831d7b96096.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n---\n\n## 如何使用\n\n 打开浏览器输入对应的暴露的地址，比如`192.168.0.1:4873`，\n\n截图如下\n\n![image.png](https://upload-images.jianshu.io/upload_images/6655013-d6ae317646b0afc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n按照截图提示，注册一个用户\n\n```shell\nnpm adduser --registry http://192.168.0.1:4873\n```\n\n安装提示输入账号，密码\n\n## 更改下载源\n\n在每一个客户端中需要更改下载源为verdaccio，这里推荐使用`nrm`，这是一个包下载源管理器。\n\n```shell\nnpm install -g nrm\n\nnrm add verdaccio http://x.x.x.x:4873/\n\nnrm use verdaccio\n```\n\n## 维护\n\n如果需要发布一个包，需要先进行登录\n\n```shell\nnpm login\n```\n\n登录成功之后，在对应的包文件夹下，改好`package.json`版本号，再执行创建发布命令\n\n```shell\nnpm publish\n```\n","slug":"利用verdaccio搭建私有npm仓库","published":1,"updated":"2019-06-19T05:24:14.988Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2yy0008bi1pcza4ek3m","content":"<p>随着时间的推移，前端的工程日益庞大，越来越复杂的依赖包需要包管理器来维护。相比搭建没有优势bower仓储，更好的方式是在局域网搭建NPM仓储，维护项目中package.json中的各个插件的版本即可维护项目依赖。</p>\n<p><a href=\"%5Bhttps://github.com/verdaccio/verdaccio%5D(https://github.com/verdaccio/verdaccio)\">verdaccio</a>是一个部署简易的可以实现github仓储私有化的npm组件，fork于<code>sinopia</code>项目，由于<code>sinopia</code>项目现在不太维护，存在一些bug，不建议使用。</p>\n<p>使用verdaccio的优势</p>\n<ul>\n<li>配置简单，开箱即用；</li>\n<li>不需要数据库,verdaccio内置一个数据库了；</li>\n<li>当源为verdaccio时, verdaccio不存在要安装的包时,会自动去设置的远程npm把包缓存到本地；</li>\n</ul>\n<h2><span id=\"1-安装verdaccio\">1. 安装verdaccio</span></h2>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i verdaccio -g</span><br></pre></td></tr></table></figure>\n<h2><span id=\"2-启动verdaccio\">2. 启动verdaccio</span></h2>\n<ul>\n<li>默认开启方式</li>\n</ul>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">verdaccio</span><br></pre></td></tr></table></figure>\n<p>启动成功截图</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-ec7bd2397fb9d6bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>其中<code>config.yaml</code>是配置文件，相关配置文件说明如下</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">storage: ./storage  //npm包存放的路径</span><br><span class=\"line\"></span><br><span class=\"line\">auth:</span><br><span class=\"line\">  htpasswd:</span><br><span class=\"line\">    file: ./htpasswd   //保存用户的账号密码等信息</span><br><span class=\"line\">    # Maximum amount of users allowed to register, defaults to \"+inf\".</span><br><span class=\"line\">    # You can set this to -1 to disable registration.</span><br><span class=\"line\">    max_users: -1  //默认为1000，改为-1，禁止注册</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> a list of other known repositories we can talk to</span><br><span class=\"line\">uplinks:</span><br><span class=\"line\">  npmjs:</span><br><span class=\"line\">    url: http://registry.npm.taobao.org/  //默认为npm的官网，由于国情，改为淘宝源</span><br><span class=\"line\"></span><br><span class=\"line\">packages:  //配置权限管理</span><br><span class=\"line\">  '@*/*':</span><br><span class=\"line\">    # scoped packages</span><br><span class=\"line\">    access: $all</span><br><span class=\"line\">    publish: $authenticated</span><br><span class=\"line\"></span><br><span class=\"line\">  '*':</span><br><span class=\"line\">    # allow all users (including non-authenticated users) to read and</span><br><span class=\"line\">    # publish all packages</span><br><span class=\"line\">    #</span><br><span class=\"line\">    # you can specify usernames/groupnames (depending on your auth plugin)</span><br><span class=\"line\">    # and three keywords: \"$all\", \"$anonymous\", \"$authenticated\"</span><br><span class=\"line\">    access: $all  // 所有人都能下载</span><br><span class=\"line\"></span><br><span class=\"line\">    # allow all known users to publish packages</span><br><span class=\"line\">    # (anyone can register by default, remember?)</span><br><span class=\"line\">    publish: $authenticated // 所有人都有发布包的权限，若想指定默认发布改成对应人的名字</span><br><span class=\"line\"></span><br><span class=\"line\">    # if package is not available locally, proxy requests to 'npmjs' registry</span><br><span class=\"line\">    proxy: npmjs  // 若安装的报在simopia没有，会去配置的npmjs地址去下载</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> log settings</span><br><span class=\"line\">logs:</span><br><span class=\"line\">  - &#123;type: stdout, format: pretty, level: http&#125;</span><br><span class=\"line\"><span class=\"meta\">  #</span>- &#123;type: file, path: verdaccio.log, level: info&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> you can specify listen address (or simply a port)</span><br><span class=\"line\">listen: 0.0.0.0:4873  // 默认没有，只能在本机访问，添加后可以通过外网访问。</span><br></pre></td></tr></table></figure>\n<p>若在服务端部署，需要以守护进程的方式，推荐使用<code>pm2</code>去开启</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start `which verdaccio`</span><br></pre></td></tr></table></figure>\n<p>pm2启动成功截图</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-dcf94831d7b96096.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<hr>\n<h2><span id=\"如何使用\">如何使用</span></h2>\n<p>打开浏览器输入对应的暴露的地址，比如<code>192.168.0.1:4873</code>，</p>\n<p>截图如下</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-d6ae317646b0afc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>按照截图提示，注册一个用户</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm adduser --registry http://192.168.0.1:4873</span><br></pre></td></tr></table></figure>\n<p>安装提示输入账号，密码</p>\n<h2><span id=\"更改下载源\">更改下载源</span></h2>\n<p>在每一个客户端中需要更改下载源为verdaccio，这里推荐使用<code>nrm</code>，这是一个包下载源管理器。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g nrm</span><br><span class=\"line\"></span><br><span class=\"line\">nrm add verdaccio http://x.x.x.x:4873/</span><br><span class=\"line\"></span><br><span class=\"line\">nrm use verdaccio</span><br></pre></td></tr></table></figure>\n<h2><span id=\"维护\">维护</span></h2>\n<p>如果需要发布一个包，需要先进行登录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm login</span><br></pre></td></tr></table></figure>\n<p>登录成功之后，在对应的包文件夹下，改好<code>package.json</code>版本号，再执行创建发布命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm publish</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>随着时间的推移，前端的工程日益庞大，越来越复杂的依赖包需要包管理器来维护。相比搭建没有优势bower仓储，更好的方式是在局域网搭建NPM仓储，维护项目中package.json中的各个插件的版本即可维护项目依赖。</p>\n<p><a href=\"%5Bhttps://github.com/verdaccio/verdaccio%5D(https://github.com/verdaccio/verdaccio)\">verdaccio</a>是一个部署简易的可以实现github仓储私有化的npm组件，fork于<code>sinopia</code>项目，由于<code>sinopia</code>项目现在不太维护，存在一些bug，不建议使用。</p>\n<p>使用verdaccio的优势</p>\n<ul>\n<li>配置简单，开箱即用；</li>\n<li>不需要数据库,verdaccio内置一个数据库了；</li>\n<li>当源为verdaccio时, verdaccio不存在要安装的包时,会自动去设置的远程npm把包缓存到本地；</li>\n</ul>\n<h2>1. 安装verdaccio</h2>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i verdaccio -g</span><br></pre></td></tr></table></figure>\n<h2>2. 启动verdaccio</h2>\n<ul>\n<li>默认开启方式</li>\n</ul>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">verdaccio</span><br></pre></td></tr></table></figure>\n<p>启动成功截图</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-ec7bd2397fb9d6bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>其中<code>config.yaml</code>是配置文件，相关配置文件说明如下</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">storage: ./storage  //npm包存放的路径</span><br><span class=\"line\"></span><br><span class=\"line\">auth:</span><br><span class=\"line\">  htpasswd:</span><br><span class=\"line\">    file: ./htpasswd   //保存用户的账号密码等信息</span><br><span class=\"line\">    # Maximum amount of users allowed to register, defaults to \"+inf\".</span><br><span class=\"line\">    # You can set this to -1 to disable registration.</span><br><span class=\"line\">    max_users: -1  //默认为1000，改为-1，禁止注册</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> a list of other known repositories we can talk to</span><br><span class=\"line\">uplinks:</span><br><span class=\"line\">  npmjs:</span><br><span class=\"line\">    url: http://registry.npm.taobao.org/  //默认为npm的官网，由于国情，改为淘宝源</span><br><span class=\"line\"></span><br><span class=\"line\">packages:  //配置权限管理</span><br><span class=\"line\">  '@*/*':</span><br><span class=\"line\">    # scoped packages</span><br><span class=\"line\">    access: $all</span><br><span class=\"line\">    publish: $authenticated</span><br><span class=\"line\"></span><br><span class=\"line\">  '*':</span><br><span class=\"line\">    # allow all users (including non-authenticated users) to read and</span><br><span class=\"line\">    # publish all packages</span><br><span class=\"line\">    #</span><br><span class=\"line\">    # you can specify usernames/groupnames (depending on your auth plugin)</span><br><span class=\"line\">    # and three keywords: \"$all\", \"$anonymous\", \"$authenticated\"</span><br><span class=\"line\">    access: $all  // 所有人都能下载</span><br><span class=\"line\"></span><br><span class=\"line\">    # allow all known users to publish packages</span><br><span class=\"line\">    # (anyone can register by default, remember?)</span><br><span class=\"line\">    publish: $authenticated // 所有人都有发布包的权限，若想指定默认发布改成对应人的名字</span><br><span class=\"line\"></span><br><span class=\"line\">    # if package is not available locally, proxy requests to 'npmjs' registry</span><br><span class=\"line\">    proxy: npmjs  // 若安装的报在simopia没有，会去配置的npmjs地址去下载</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> log settings</span><br><span class=\"line\">logs:</span><br><span class=\"line\">  - &#123;type: stdout, format: pretty, level: http&#125;</span><br><span class=\"line\"><span class=\"meta\">  #</span>- &#123;type: file, path: verdaccio.log, level: info&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> you can specify listen address (or simply a port)</span><br><span class=\"line\">listen: 0.0.0.0:4873  // 默认没有，只能在本机访问，添加后可以通过外网访问。</span><br></pre></td></tr></table></figure>\n<p>若在服务端部署，需要以守护进程的方式，推荐使用<code>pm2</code>去开启</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start `which verdaccio`</span><br></pre></td></tr></table></figure>\n<p>pm2启动成功截图</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-dcf94831d7b96096.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<hr>\n<h2>如何使用</h2>\n<p>打开浏览器输入对应的暴露的地址，比如<code>192.168.0.1:4873</code>，</p>\n<p>截图如下</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/6655013-d6ae317646b0afc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>按照截图提示，注册一个用户</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm adduser --registry http://192.168.0.1:4873</span><br></pre></td></tr></table></figure>\n<p>安装提示输入账号，密码</p>\n<h2>更改下载源</h2>\n<p>在每一个客户端中需要更改下载源为verdaccio，这里推荐使用<code>nrm</code>，这是一个包下载源管理器。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g nrm</span><br><span class=\"line\"></span><br><span class=\"line\">nrm add verdaccio http://x.x.x.x:4873/</span><br><span class=\"line\"></span><br><span class=\"line\">nrm use verdaccio</span><br></pre></td></tr></table></figure>\n<h2>维护</h2>\n<p>如果需要发布一个包，需要先进行登录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm login</span><br></pre></td></tr></table></figure>\n<p>登录成功之后，在对应的包文件夹下，改好<code>package.json</code>版本号，再执行创建发布命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm publish</span><br></pre></td></tr></table></figure>\n"},{"title":"序","catalog":true,"date":"2019-06-15T06:00:06.000Z","subtitle":null,"header-img":null,"_content":"\nhello，大家好，我是黄晨，来自江苏泰州，前端开发一枚。\n\n搭建这个博客的原因，主要受限于以下几点：\n\n1. 平时学习、积累的知识需要有一个平台去记录，之前也使用了比如掘金、简书、博客园、github这些网站去在线记录，一开始还能满足自己的需求，后来慢慢觉得还是需要有一个自己的博客，提供一种更自由、个性化的编写体验以及阅读体验；\n2. 知识点需要查阅，温故知新，查漏补缺；\n3. 分享自己遇到的一些知识和经验给其他人去参考和借鉴；\n4. 锻炼书写表达能力；\n5. 希望五年、十年以后回头再查阅自己博客的时候会有另一番风味体验；\n\n如果有任何疑问或者问题咨询，欢迎留言向我咨询；\n\n谢谢。\n","source":"_posts/序.md","raw":"---\ntitle: 序\ncatalog: true\ndate: 2019-06-15 14:00:06\nsubtitle:\nheader-img:\ntags: 随笔\n---\n\nhello，大家好，我是黄晨，来自江苏泰州，前端开发一枚。\n\n搭建这个博客的原因，主要受限于以下几点：\n\n1. 平时学习、积累的知识需要有一个平台去记录，之前也使用了比如掘金、简书、博客园、github这些网站去在线记录，一开始还能满足自己的需求，后来慢慢觉得还是需要有一个自己的博客，提供一种更自由、个性化的编写体验以及阅读体验；\n2. 知识点需要查阅，温故知新，查漏补缺；\n3. 分享自己遇到的一些知识和经验给其他人去参考和借鉴；\n4. 锻炼书写表达能力；\n5. 希望五年、十年以后回头再查阅自己博客的时候会有另一番风味体验；\n\n如果有任何疑问或者问题咨询，欢迎留言向我咨询；\n\n谢谢。\n","slug":"序","published":1,"updated":"2019-06-19T05:32:48.462Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2yz0009bi1pwsvxx4wp","content":"<p>hello，大家好，我是黄晨，来自江苏泰州，前端开发一枚。</p>\n<p>搭建这个博客的原因，主要受限于以下几点：</p>\n<ol>\n<li>平时学习、积累的知识需要有一个平台去记录，之前也使用了比如掘金、简书、博客园、github这些网站去在线记录，一开始还能满足自己的需求，后来慢慢觉得还是需要有一个自己的博客，提供一种更自由、个性化的编写体验以及阅读体验；</li>\n<li>知识点需要查阅，温故知新，查漏补缺；</li>\n<li>分享自己遇到的一些知识和经验给其他人去参考和借鉴；</li>\n<li>锻炼书写表达能力；</li>\n<li>希望五年、十年以后回头再查阅自己博客的时候会有另一番风味体验；</li>\n</ol>\n<p>如果有任何疑问或者问题咨询，欢迎留言向我咨询；</p>\n<p>谢谢。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>hello，大家好，我是黄晨，来自江苏泰州，前端开发一枚。</p>\n<p>搭建这个博客的原因，主要受限于以下几点：</p>\n<ol>\n<li>平时学习、积累的知识需要有一个平台去记录，之前也使用了比如掘金、简书、博客园、github这些网站去在线记录，一开始还能满足自己的需求，后来慢慢觉得还是需要有一个自己的博客，提供一种更自由、个性化的编写体验以及阅读体验；</li>\n<li>知识点需要查阅，温故知新，查漏补缺；</li>\n<li>分享自己遇到的一些知识和经验给其他人去参考和借鉴；</li>\n<li>锻炼书写表达能力；</li>\n<li>希望五年、十年以后回头再查阅自己博客的时候会有另一番风味体验；</li>\n</ol>\n<p>如果有任何疑问或者问题咨询，欢迎留言向我咨询；</p>\n<p>谢谢。</p>\n"},{"title":"nginx入门","catalog":true,"date":"2019-06-19T05:34:23.000Z","subtitle":null,"header-img":null,"_content":"\n1. 环境\n\n    CENTOS>=7.0,位数 X64 CENTOS 7.2\n\n2. 关闭 iptables\n\n    iptables命令是Linux上常用的防火墙软件\n\n    | 功能        | 命令           |\n    | :------------- |:-------------|\n    | 停止防火墙      | systemctl stop firewalld.service |\n    | 永久关闭防火墙   | systemctl disable firewalld.service |\n\n3. 安装依赖\n\n    ```shell\n    yum  -y install gcc gcc-c++ autoconf pcre pcre-devel make automake\n    yum  -y install wget httpd-tools vim\n    ```\n\n4. 开始安装nginx\n\n    新建一个文件\n\n    ```shell\n    vi /etc/yum.repos.d/nginx.repo\n    ```\n\n    内容输入如下：\n\n    ```shell\n    [nginx]\n    name=nginx repo\n    baseurl=http://nginx.org/packages/centos/7/$basearch/\n    gpgcheck=0\n    enabled=1\n    ```\n\n    其中 centos/7 根据自己运行环境配置 系统名/版本号\n\n    下载nginx\n\n    ```shell\n    yum install nginx -y\n    nginx -v\n    nginx -V\n    ```\n\n---\n\n## nginx常用操作\n\n1. 查看配置文件和目录\n\n    ```shell\n    rpm -ql nginx\n    ```\n\n    相关文件说明：\n\n    | 类型 | 路径  | 用途 |\n    | :--- | :--- | :-- |\n    | 配置文件| /etc/logrotate.d/nginx| 用于logrotate服务的日志切割\n    | 配置文件| /etc/nginx /etc/nginx/nginx.conf /etc/nginx/conf.d /etc/nginx/conf.d/default.conf| 主配置文件\n    | 配置文件| /etc/nginx/fastcgi_params /etc/nginx/scgi_params /etc/nginx/uwsgi_params| cgi配置,fastcgi配置\n    | 配置文件| /etc/nginx/koi-utf /etc/nginx/koi-win /etc/nginx/win-utf| 编码转换映射转化文件\n    | 配置文件| /etc/nginx/mime.types| 设置http协议的Content-Type与扩展名对应关系\n    | 配置文件| /usr/lib/systemd/system/nginx-debug.service /usr/lib/systemd/system/nginx.service /etc/sysconfig/nginx /etc/sysconfig/nginx-debug| 用于配置系统守护进程管理器管理方式\n    | 配置文件| /etc/nginx/modules /usr/lib64/nginx/modules| nginx模块目录\n    | 命令| /usr/share/doc/nginx-1.14.0 /usr/share/doc/nginx-1.14.0/COPYRIGHT| nginx的手册和帮助文件\n    | 目录| /var/cache/nginx| nginx的缓存目录\n    | 目录| /var/log/nginx| nginx的日志目录\n\n2. 启动和重新加载以及关闭\n\n    ```shell\n    systemctl restart nginx.service\n    systemctl reload nginx.service\n    systemctl stop nginx.service\n\n    nginx -s reload\n    ```\n\n    如果在启动的时候可能会遇到下列问题：\n\n    1. 端口被占用；\n\n    ```shell\n    Starting nginx: nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] still could not bind\n\n    ```\n\n    可以先查看进程，再杀死对应进程\n\n    ```shell\n    netstat -ntpl\n\n    kill 进程号\n    ```\n\n3. 配置nginx\n\n  > /etc/nginx/nginx.conf\n\n 查看日志命令 tailf -f log目录\n\n  ```shell\n    user  nginx;   设置nginx服务的系统使用用户  \n    worker_processes  1;  工作进程数,一般和CPU数量相同\n\n    error_log  /var/log/nginx/error.log warn;   nginx的错误日志  \n    pid        /var/run/nginx.pid;   nginx服务启动时的pid\n\n    events {\n        worker_connections  1024;每个进程允许的最大连接数 10000\n    }\n\n    http {\n        include       /etc/nginx/mime.types;//文件后缀和类型类型的对应关系\n        default_type  application/octet-stream;//默认content-type\n\n        log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                        '$status $body_bytes_sent \"$http_referer\" '\n                        '\"$http_user_agent\" \"$http_x_forwarded_for\"';  //日志记录格式\n\n        access_log  /var/log/nginx/access.log  main;//默认访问日志 日志格式与log_format main 对应\n\n        sendfile        on;//启用sendfile\n        #tcp_nopush     on;//懒发送 客户端请求数据不会每次都时时相应 让数据塞满一次性发送给客户端（多用于下载、断点 续传）\n        #tcp_nodelay on; // 默认开启 与nopush互斥 提高实时请求响应效率\n\n        keepalive_timeout  65;//超时时间是65秒\n\n        #gzip  on;gzip压缩\n\n        include /etc/nginx/conf.d/*.conf;//包含的子配置文件\n    }\n  ```\n\n  > /etc/default.conf\n\n  ```shell\n    server {\n        listen       80;\n        # 用域名方式访问的地址\n        server_name  localhost;  \n\n        #charset koi8-r; //编码\n        #access_log  /var/log/nginx/host.access.log  main;  //访问日志文件和名称\n\n        # 代理\n        location / {\n            proxy_pass http://localhost:3000\n        }\n\n\n        # 转发请求静态资源（js、css）规则\n        location ~ .*\\.(html|js|css)$ {\n            # CORS\n            add_header Access-Control-Allow-Origin *;\n            add_header Access-Control-Allow-Methods GET,POST,DELETE;\n            add_header Access-Control-Allow-Headers Content-Type;\n            # 默认带上客户端cookie\n            add_header Access-Control-Allow-Credentials true;\n            # 缓存1h\n            expires 1h;\n            # 开启gzip\n            gzip on;\n            # gzip压缩HTTP版本号 一般是1.1\n            gzip_http_version 1.1;\n            # gzip压缩等级 越大压缩率越高 1-9\n            gzip_comp_level 2;\n            # 默认不指定不会缓存css资源 需要指定text/css类型\n            gzip_types application/javascript text/css;\n            # 资源目录\n            root /data/html;\n        }\n\n        # 设置图片请求规则\n        location ~ .*\\.(gif|png|jpg|webp)$ {\n            expires 1h;\n            gzip on;\n            gzip_http_version 1.1;\n            gzip_comp_level 3;\n            gzip_types image/jpeg image/png image/gif image/webp;\n            ## 防盗链\n            valid_referers none blocked xx.xxx.xxx.xx;\n            if ($invalid_referer) {\n                return 403;\n            }\n            # 资源目录\n            root /data/html;\n        }\n\n        location ~ ^/download {\n            # 默认先查找当前目录下的后缀为.gz文件 有直接返回给客户端 不需要再压缩\n            # linux下运行gzip 文件名会生成压缩gz文件\n            # url最直接访问该文件路径就会自动启动下载该资源\n            gzip_static on;\n            tcp_nopush on;  \n            root /data/download;\n        }\n\n        location / {\n            root   /usr/share/nginx/html;  //静态文件根目录\n            index  index.html index.htm;  //首页的索引文件\n        }\n\n        #error_page  404              /404.html;  //指定错误页面\n\n        # redirect server error pages to the static page /50x.html\n        # 把后台错误重定向到静态的50x.html页面\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        # 把PHP脚本9000端口上监听的FastCGI服务\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # 不允许访问.htaccess文件 只允许指定的ip访问\n        location ~ /\\.ht {\n            allow 127.0.0.1\n            deny  all;\n        }\n    }\n  ```\n\n> 实现负载均衡\n\n1. 解决高并发、海量数据问题\n2. 配置类型\n    1. 轮询（默认） 每个请求按照时间顺序逐一分配不同的后端服务器；\n    2. ip_hash 每个请求按访问ip的hash结果分配，这样每个访客固定放一个后端服务器，可以解决session的问题；\n    3. weight（加权轮询）指定轮询策略，weight和访问比率成正比，用于后端服务器性能不均的情况；\n    4. least_conn 最小连接数，哪个连接少就分给谁。\n\n    集群状态：\n\n| 状态 | 描述 |\n| :--- | :--- |\n| down | 不参与负载均衡 |\n| backup | 备份的服务器 |\n| max_fails | 允许请求失败的次数 |\n| fail_timeout | 经过max_fails失败后，服务暂停的时间 |\n| max_conts | 限制最大的接收的连接数 |\n\n```shell\n    upstream test1 {\n        ip_hsah;\n        server http://localhost:3000 weight=2;\n        server http://localhost:4000 weight=1;\n        server http://localhost:5000 down;\n    }\n\n    server {\n        # 访问负载均衡构造的集群\n        location / {\n            # 和upstrem的name对应\n            proxy_pass http://test1;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test1.com;\n        location / {\n            proxy_pass http://localhost:3000;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test2.com;\n        location / {\n            proxy_pass http://localhost:4000;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test3.com;\n        location / {\n            proxy_pass http://localhost:5000;\n        }\n    }\n\n```\n\n此时访问`www.test.com`通过代理到访问`www.test1.com`，而访问test1的请求被负载均衡按照策略访问test1或者test2\n","source":"_posts/nginx入门.md","raw":"---\ntitle: nginx入门\ncatalog: true\ndate: 2019-06-19 13:34:23\nsubtitle:\nheader-img:\ntags: nginx\n---\n\n1. 环境\n\n    CENTOS>=7.0,位数 X64 CENTOS 7.2\n\n2. 关闭 iptables\n\n    iptables命令是Linux上常用的防火墙软件\n\n    | 功能        | 命令           |\n    | :------------- |:-------------|\n    | 停止防火墙      | systemctl stop firewalld.service |\n    | 永久关闭防火墙   | systemctl disable firewalld.service |\n\n3. 安装依赖\n\n    ```shell\n    yum  -y install gcc gcc-c++ autoconf pcre pcre-devel make automake\n    yum  -y install wget httpd-tools vim\n    ```\n\n4. 开始安装nginx\n\n    新建一个文件\n\n    ```shell\n    vi /etc/yum.repos.d/nginx.repo\n    ```\n\n    内容输入如下：\n\n    ```shell\n    [nginx]\n    name=nginx repo\n    baseurl=http://nginx.org/packages/centos/7/$basearch/\n    gpgcheck=0\n    enabled=1\n    ```\n\n    其中 centos/7 根据自己运行环境配置 系统名/版本号\n\n    下载nginx\n\n    ```shell\n    yum install nginx -y\n    nginx -v\n    nginx -V\n    ```\n\n---\n\n## nginx常用操作\n\n1. 查看配置文件和目录\n\n    ```shell\n    rpm -ql nginx\n    ```\n\n    相关文件说明：\n\n    | 类型 | 路径  | 用途 |\n    | :--- | :--- | :-- |\n    | 配置文件| /etc/logrotate.d/nginx| 用于logrotate服务的日志切割\n    | 配置文件| /etc/nginx /etc/nginx/nginx.conf /etc/nginx/conf.d /etc/nginx/conf.d/default.conf| 主配置文件\n    | 配置文件| /etc/nginx/fastcgi_params /etc/nginx/scgi_params /etc/nginx/uwsgi_params| cgi配置,fastcgi配置\n    | 配置文件| /etc/nginx/koi-utf /etc/nginx/koi-win /etc/nginx/win-utf| 编码转换映射转化文件\n    | 配置文件| /etc/nginx/mime.types| 设置http协议的Content-Type与扩展名对应关系\n    | 配置文件| /usr/lib/systemd/system/nginx-debug.service /usr/lib/systemd/system/nginx.service /etc/sysconfig/nginx /etc/sysconfig/nginx-debug| 用于配置系统守护进程管理器管理方式\n    | 配置文件| /etc/nginx/modules /usr/lib64/nginx/modules| nginx模块目录\n    | 命令| /usr/share/doc/nginx-1.14.0 /usr/share/doc/nginx-1.14.0/COPYRIGHT| nginx的手册和帮助文件\n    | 目录| /var/cache/nginx| nginx的缓存目录\n    | 目录| /var/log/nginx| nginx的日志目录\n\n2. 启动和重新加载以及关闭\n\n    ```shell\n    systemctl restart nginx.service\n    systemctl reload nginx.service\n    systemctl stop nginx.service\n\n    nginx -s reload\n    ```\n\n    如果在启动的时候可能会遇到下列问题：\n\n    1. 端口被占用；\n\n    ```shell\n    Starting nginx: nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)\n    nginx: [emerg] still could not bind\n\n    ```\n\n    可以先查看进程，再杀死对应进程\n\n    ```shell\n    netstat -ntpl\n\n    kill 进程号\n    ```\n\n3. 配置nginx\n\n  > /etc/nginx/nginx.conf\n\n 查看日志命令 tailf -f log目录\n\n  ```shell\n    user  nginx;   设置nginx服务的系统使用用户  \n    worker_processes  1;  工作进程数,一般和CPU数量相同\n\n    error_log  /var/log/nginx/error.log warn;   nginx的错误日志  \n    pid        /var/run/nginx.pid;   nginx服务启动时的pid\n\n    events {\n        worker_connections  1024;每个进程允许的最大连接数 10000\n    }\n\n    http {\n        include       /etc/nginx/mime.types;//文件后缀和类型类型的对应关系\n        default_type  application/octet-stream;//默认content-type\n\n        log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                        '$status $body_bytes_sent \"$http_referer\" '\n                        '\"$http_user_agent\" \"$http_x_forwarded_for\"';  //日志记录格式\n\n        access_log  /var/log/nginx/access.log  main;//默认访问日志 日志格式与log_format main 对应\n\n        sendfile        on;//启用sendfile\n        #tcp_nopush     on;//懒发送 客户端请求数据不会每次都时时相应 让数据塞满一次性发送给客户端（多用于下载、断点 续传）\n        #tcp_nodelay on; // 默认开启 与nopush互斥 提高实时请求响应效率\n\n        keepalive_timeout  65;//超时时间是65秒\n\n        #gzip  on;gzip压缩\n\n        include /etc/nginx/conf.d/*.conf;//包含的子配置文件\n    }\n  ```\n\n  > /etc/default.conf\n\n  ```shell\n    server {\n        listen       80;\n        # 用域名方式访问的地址\n        server_name  localhost;  \n\n        #charset koi8-r; //编码\n        #access_log  /var/log/nginx/host.access.log  main;  //访问日志文件和名称\n\n        # 代理\n        location / {\n            proxy_pass http://localhost:3000\n        }\n\n\n        # 转发请求静态资源（js、css）规则\n        location ~ .*\\.(html|js|css)$ {\n            # CORS\n            add_header Access-Control-Allow-Origin *;\n            add_header Access-Control-Allow-Methods GET,POST,DELETE;\n            add_header Access-Control-Allow-Headers Content-Type;\n            # 默认带上客户端cookie\n            add_header Access-Control-Allow-Credentials true;\n            # 缓存1h\n            expires 1h;\n            # 开启gzip\n            gzip on;\n            # gzip压缩HTTP版本号 一般是1.1\n            gzip_http_version 1.1;\n            # gzip压缩等级 越大压缩率越高 1-9\n            gzip_comp_level 2;\n            # 默认不指定不会缓存css资源 需要指定text/css类型\n            gzip_types application/javascript text/css;\n            # 资源目录\n            root /data/html;\n        }\n\n        # 设置图片请求规则\n        location ~ .*\\.(gif|png|jpg|webp)$ {\n            expires 1h;\n            gzip on;\n            gzip_http_version 1.1;\n            gzip_comp_level 3;\n            gzip_types image/jpeg image/png image/gif image/webp;\n            ## 防盗链\n            valid_referers none blocked xx.xxx.xxx.xx;\n            if ($invalid_referer) {\n                return 403;\n            }\n            # 资源目录\n            root /data/html;\n        }\n\n        location ~ ^/download {\n            # 默认先查找当前目录下的后缀为.gz文件 有直接返回给客户端 不需要再压缩\n            # linux下运行gzip 文件名会生成压缩gz文件\n            # url最直接访问该文件路径就会自动启动下载该资源\n            gzip_static on;\n            tcp_nopush on;  \n            root /data/download;\n        }\n\n        location / {\n            root   /usr/share/nginx/html;  //静态文件根目录\n            index  index.html index.htm;  //首页的索引文件\n        }\n\n        #error_page  404              /404.html;  //指定错误页面\n\n        # redirect server error pages to the static page /50x.html\n        # 把后台错误重定向到静态的50x.html页面\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        # 把PHP脚本9000端口上监听的FastCGI服务\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # 不允许访问.htaccess文件 只允许指定的ip访问\n        location ~ /\\.ht {\n            allow 127.0.0.1\n            deny  all;\n        }\n    }\n  ```\n\n> 实现负载均衡\n\n1. 解决高并发、海量数据问题\n2. 配置类型\n    1. 轮询（默认） 每个请求按照时间顺序逐一分配不同的后端服务器；\n    2. ip_hash 每个请求按访问ip的hash结果分配，这样每个访客固定放一个后端服务器，可以解决session的问题；\n    3. weight（加权轮询）指定轮询策略，weight和访问比率成正比，用于后端服务器性能不均的情况；\n    4. least_conn 最小连接数，哪个连接少就分给谁。\n\n    集群状态：\n\n| 状态 | 描述 |\n| :--- | :--- |\n| down | 不参与负载均衡 |\n| backup | 备份的服务器 |\n| max_fails | 允许请求失败的次数 |\n| fail_timeout | 经过max_fails失败后，服务暂停的时间 |\n| max_conts | 限制最大的接收的连接数 |\n\n```shell\n    upstream test1 {\n        ip_hsah;\n        server http://localhost:3000 weight=2;\n        server http://localhost:4000 weight=1;\n        server http://localhost:5000 down;\n    }\n\n    server {\n        # 访问负载均衡构造的集群\n        location / {\n            # 和upstrem的name对应\n            proxy_pass http://test1;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test1.com;\n        location / {\n            proxy_pass http://localhost:3000;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test2.com;\n        location / {\n            proxy_pass http://localhost:4000;\n        }\n    }\n    server {\n        listen 80;\n        server_name www.test3.com;\n        location / {\n            proxy_pass http://localhost:5000;\n        }\n    }\n\n```\n\n此时访问`www.test.com`通过代理到访问`www.test1.com`，而访问test1的请求被负载均衡按照策略访问test1或者test2\n","slug":"nginx入门","published":1,"updated":"2019-06-19T06:02:17.302Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjx3bm2ze000jbi1pe831uxs5","content":"<ol>\n<li>\n<p>环境</p>\n<p>CENTOS&gt;=7.0,位数 X64 CENTOS 7.2</p>\n</li>\n<li>\n<p>关闭 iptables</p>\n<p>iptables命令是Linux上常用的防火墙软件</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:left\">命令</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">停止防火墙</td>\n<td style=\"text-align:left\">systemctl stop firewalld.service</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">永久关闭防火墙</td>\n<td style=\"text-align:left\">systemctl disable firewalld.service</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>安装依赖</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum  -y install gcc gcc-c++ autoconf pcre pcre-devel make automake</span><br><span class=\"line\">yum  -y install wget httpd-tools vim</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>开始安装nginx</p>\n<p>新建一个文件</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/yum.repos.d/nginx.repo</span><br></pre></td></tr></table></figure>\n<p>内容输入如下：</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx]</span><br><span class=\"line\">name=nginx repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/7/$basearch/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\">enabled=1</span><br></pre></td></tr></table></figure>\n<p>其中 centos/7 根据自己运行环境配置 系统名/版本号</p>\n<p>下载nginx</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install nginx -y</span><br><span class=\"line\">nginx -v</span><br><span class=\"line\">nginx -V</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h2><span id=\"nginx常用操作\">nginx常用操作</span></h2>\n<ol>\n<li>\n<p>查看配置文件和目录</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm -ql nginx</span><br></pre></td></tr></table></figure>\n<p>相关文件说明：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">类型</th>\n<th style=\"text-align:left\">路径</th>\n<th style=\"text-align:left\">用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/logrotate.d/nginx</td>\n<td style=\"text-align:left\">用于logrotate服务的日志切割</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx /etc/nginx/nginx.conf /etc/nginx/conf.d /etc/nginx/conf.d/default.conf</td>\n<td style=\"text-align:left\">主配置文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/fastcgi_params /etc/nginx/scgi_params /etc/nginx/uwsgi_params</td>\n<td style=\"text-align:left\">cgi配置,fastcgi配置</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/koi-utf /etc/nginx/koi-win /etc/nginx/win-utf</td>\n<td style=\"text-align:left\">编码转换映射转化文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/mime.types</td>\n<td style=\"text-align:left\">设置http协议的Content-Type与扩展名对应关系</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/usr/lib/systemd/system/nginx-debug.service /usr/lib/systemd/system/nginx.service /etc/sysconfig/nginx /etc/sysconfig/nginx-debug</td>\n<td style=\"text-align:left\">用于配置系统守护进程管理器管理方式</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/modules /usr/lib64/nginx/modules</td>\n<td style=\"text-align:left\">nginx模块目录</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">命令</td>\n<td style=\"text-align:left\">/usr/share/doc/nginx-1.14.0 /usr/share/doc/nginx-1.14.0/COPYRIGHT</td>\n<td style=\"text-align:left\">nginx的手册和帮助文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">目录</td>\n<td style=\"text-align:left\">/var/cache/nginx</td>\n<td style=\"text-align:left\">nginx的缓存目录</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">目录</td>\n<td style=\"text-align:left\">/var/log/nginx</td>\n<td style=\"text-align:left\">nginx的日志目录</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>启动和重新加载以及关闭</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx.service</span><br><span class=\"line\">systemctl reload nginx.service</span><br><span class=\"line\">systemctl stop nginx.service</span><br><span class=\"line\"></span><br><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>如果在启动的时候可能会遇到下列问题：</p>\n<ol>\n<li>端口被占用；</li>\n</ol>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Starting nginx: nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\"></span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] still could not bind</span><br></pre></td></tr></table></figure>\n<p>可以先查看进程，再杀死对应进程</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -ntpl</span><br><span class=\"line\"></span><br><span class=\"line\">kill 进程号</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>配置nginx</p>\n</li>\n</ol>\n<blockquote>\n<p>/etc/nginx/nginx.conf</p>\n</blockquote>\n<p>查看日志命令 tailf -f log目录</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">user  nginx;   设置nginx服务的系统使用用户  </span><br><span class=\"line\">worker_processes  1;  工作进程数,一般和CPU数量相同</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;   nginx的错误日志  </span><br><span class=\"line\">pid        /var/run/nginx.pid;   nginx服务启动时的pid</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;每个进程允许的最大连接数 10000</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;//文件后缀和类型类型的对应关系</span><br><span class=\"line\">    default_type  application/octet-stream;//默认content-type</span><br><span class=\"line\"></span><br><span class=\"line\">    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '</span><br><span class=\"line\">                    '$status $body_bytes_sent \"$http_referer\" '</span><br><span class=\"line\">                    '\"$http_user_agent\" \"$http_x_forwarded_for\"';  //日志记录格式</span><br><span class=\"line\"></span><br><span class=\"line\">    access_log  /var/log/nginx/access.log  main;//默认访问日志 日志格式与log_format main 对应</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;//启用sendfile</span><br><span class=\"line\">    #tcp_nopush     on;//懒发送 客户端请求数据不会每次都时时相应 让数据塞满一次性发送给客户端（多用于下载、断点 续传）</span><br><span class=\"line\">    #tcp_nodelay on; // 默认开启 与nopush互斥 提高实时请求响应效率</span><br><span class=\"line\"></span><br><span class=\"line\">    keepalive_timeout  65;//超时时间是65秒</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;gzip压缩</span><br><span class=\"line\"></span><br><span class=\"line\">    include /etc/nginx/conf.d/*.conf;//包含的子配置文件</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>/etc/default.conf</p>\n</blockquote>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    # 用域名方式访问的地址</span><br><span class=\"line\">    server_name  localhost;  </span><br><span class=\"line\"></span><br><span class=\"line\">    #charset koi8-r; //编码</span><br><span class=\"line\">    #access_log  /var/log/nginx/host.access.log  main;  //访问日志文件和名称</span><br><span class=\"line\"></span><br><span class=\"line\">    # 代理</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:3000</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # 转发请求静态资源（js、css）规则</span><br><span class=\"line\">    location ~ .*\\.(html|js|css)$ &#123;</span><br><span class=\"line\">        # CORS</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">        add_header Access-Control-Allow-Methods GET,POST,DELETE;</span><br><span class=\"line\">        add_header Access-Control-Allow-Headers Content-Type;</span><br><span class=\"line\">        # 默认带上客户端cookie</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">        # 缓存1h</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">        # 开启gzip</span><br><span class=\"line\">        gzip on;</span><br><span class=\"line\">        # gzip压缩HTTP版本号 一般是1.1</span><br><span class=\"line\">        gzip_http_version 1.1;</span><br><span class=\"line\">        # gzip压缩等级 越大压缩率越高 1-9</span><br><span class=\"line\">        gzip_comp_level 2;</span><br><span class=\"line\">        # 默认不指定不会缓存css资源 需要指定text/css类型</span><br><span class=\"line\">        gzip_types application/javascript text/css;</span><br><span class=\"line\">        # 资源目录</span><br><span class=\"line\">        root /data/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 设置图片请求规则</span><br><span class=\"line\">    location ~ .*\\.(gif|png|jpg|webp)$ &#123;</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">        gzip on;</span><br><span class=\"line\">        gzip_http_version 1.1;</span><br><span class=\"line\">        gzip_comp_level 3;</span><br><span class=\"line\">        gzip_types image/jpeg image/png image/gif image/webp;</span><br><span class=\"line\">        ## 防盗链</span><br><span class=\"line\">        valid_referers none blocked xx.xxx.xxx.xx;</span><br><span class=\"line\">        if ($invalid_referer) &#123;</span><br><span class=\"line\">            return 403;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        # 资源目录</span><br><span class=\"line\">        root /data/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ ^/download &#123;</span><br><span class=\"line\">        # 默认先查找当前目录下的后缀为.gz文件 有直接返回给客户端 不需要再压缩</span><br><span class=\"line\">        # linux下运行gzip 文件名会生成压缩gz文件</span><br><span class=\"line\">        # url最直接访问该文件路径就会自动启动下载该资源</span><br><span class=\"line\">        gzip_static on;</span><br><span class=\"line\">        tcp_nopush on;  </span><br><span class=\"line\">        root /data/download;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;  //静态文件根目录</span><br><span class=\"line\">        index  index.html index.htm;  //首页的索引文件</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #error_page  404              /404.html;  //指定错误页面</span><br><span class=\"line\"></span><br><span class=\"line\">    # redirect server error pages to the static page /50x.html</span><br><span class=\"line\">    # 把后台错误重定向到静态的50x.html页面</span><br><span class=\"line\">    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">    location = /50x.html &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">    # 把PHP脚本9000端口上监听的FastCGI服务</span><br><span class=\"line\">    #location ~ \\.php$ &#123;</span><br><span class=\"line\">    #    root           html;</span><br><span class=\"line\">    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">    #    fastcgi_index  index.php;</span><br><span class=\"line\">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">    #    include        fastcgi_params;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 不允许访问.htaccess文件 只允许指定的ip访问</span><br><span class=\"line\">    location ~ /\\.ht &#123;</span><br><span class=\"line\">        allow 127.0.0.1</span><br><span class=\"line\">        deny  all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>实现负载均衡</p>\n</blockquote>\n<ol>\n<li>\n<p>解决高并发、海量数据问题</p>\n</li>\n<li>\n<p>配置类型</p>\n<ol>\n<li>轮询（默认） 每个请求按照时间顺序逐一分配不同的后端服务器；</li>\n<li>ip_hash 每个请求按访问ip的hash结果分配，这样每个访客固定放一个后端服务器，可以解决session的问题；</li>\n<li>weight（加权轮询）指定轮询策略，weight和访问比率成正比，用于后端服务器性能不均的情况；</li>\n<li>least_conn 最小连接数，哪个连接少就分给谁。</li>\n</ol>\n<p>集群状态：</p>\n</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">状态</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">down</td>\n<td style=\"text-align:left\">不参与负载均衡</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">backup</td>\n<td style=\"text-align:left\">备份的服务器</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">max_fails</td>\n<td style=\"text-align:left\">允许请求失败的次数</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">fail_timeout</td>\n<td style=\"text-align:left\">经过max_fails失败后，服务暂停的时间</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">max_conts</td>\n<td style=\"text-align:left\">限制最大的接收的连接数</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream test1 &#123;</span><br><span class=\"line\">    ip_hsah;</span><br><span class=\"line\">    server http://localhost:3000 weight=2;</span><br><span class=\"line\">    server http://localhost:4000 weight=1;</span><br><span class=\"line\">    server http://localhost:5000 down;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    # 访问负载均衡构造的集群</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        # 和upstrem的name对应</span><br><span class=\"line\">        proxy_pass http://test1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test1.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:3000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test2.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:4000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test3.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:5000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>此时访问<code>www.test.com</code>通过代理到访问<code>www.test1.com</code>，而访问test1的请求被负载均衡按照策略访问test1或者test2</p>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li>\n<p>环境</p>\n<p>CENTOS&gt;=7.0,位数 X64 CENTOS 7.2</p>\n</li>\n<li>\n<p>关闭 iptables</p>\n<p>iptables命令是Linux上常用的防火墙软件</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:left\">命令</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">停止防火墙</td>\n<td style=\"text-align:left\">systemctl stop firewalld.service</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">永久关闭防火墙</td>\n<td style=\"text-align:left\">systemctl disable firewalld.service</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>安装依赖</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum  -y install gcc gcc-c++ autoconf pcre pcre-devel make automake</span><br><span class=\"line\">yum  -y install wget httpd-tools vim</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>开始安装nginx</p>\n<p>新建一个文件</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/yum.repos.d/nginx.repo</span><br></pre></td></tr></table></figure>\n<p>内容输入如下：</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx]</span><br><span class=\"line\">name=nginx repo</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/7/$basearch/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\">enabled=1</span><br></pre></td></tr></table></figure>\n<p>其中 centos/7 根据自己运行环境配置 系统名/版本号</p>\n<p>下载nginx</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install nginx -y</span><br><span class=\"line\">nginx -v</span><br><span class=\"line\">nginx -V</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h2>nginx常用操作</h2>\n<ol>\n<li>\n<p>查看配置文件和目录</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm -ql nginx</span><br></pre></td></tr></table></figure>\n<p>相关文件说明：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">类型</th>\n<th style=\"text-align:left\">路径</th>\n<th style=\"text-align:left\">用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/logrotate.d/nginx</td>\n<td style=\"text-align:left\">用于logrotate服务的日志切割</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx /etc/nginx/nginx.conf /etc/nginx/conf.d /etc/nginx/conf.d/default.conf</td>\n<td style=\"text-align:left\">主配置文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/fastcgi_params /etc/nginx/scgi_params /etc/nginx/uwsgi_params</td>\n<td style=\"text-align:left\">cgi配置,fastcgi配置</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/koi-utf /etc/nginx/koi-win /etc/nginx/win-utf</td>\n<td style=\"text-align:left\">编码转换映射转化文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/mime.types</td>\n<td style=\"text-align:left\">设置http协议的Content-Type与扩展名对应关系</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/usr/lib/systemd/system/nginx-debug.service /usr/lib/systemd/system/nginx.service /etc/sysconfig/nginx /etc/sysconfig/nginx-debug</td>\n<td style=\"text-align:left\">用于配置系统守护进程管理器管理方式</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">配置文件</td>\n<td style=\"text-align:left\">/etc/nginx/modules /usr/lib64/nginx/modules</td>\n<td style=\"text-align:left\">nginx模块目录</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">命令</td>\n<td style=\"text-align:left\">/usr/share/doc/nginx-1.14.0 /usr/share/doc/nginx-1.14.0/COPYRIGHT</td>\n<td style=\"text-align:left\">nginx的手册和帮助文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">目录</td>\n<td style=\"text-align:left\">/var/cache/nginx</td>\n<td style=\"text-align:left\">nginx的缓存目录</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">目录</td>\n<td style=\"text-align:left\">/var/log/nginx</td>\n<td style=\"text-align:left\">nginx的日志目录</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>启动和重新加载以及关闭</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx.service</span><br><span class=\"line\">systemctl reload nginx.service</span><br><span class=\"line\">systemctl stop nginx.service</span><br><span class=\"line\"></span><br><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>如果在启动的时候可能会遇到下列问题：</p>\n<ol>\n<li>端口被占用；</li>\n</ol>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Starting nginx: nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\"></span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use)</span><br><span class=\"line\">nginx: [emerg] still could not bind</span><br></pre></td></tr></table></figure>\n<p>可以先查看进程，再杀死对应进程</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -ntpl</span><br><span class=\"line\"></span><br><span class=\"line\">kill 进程号</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>配置nginx</p>\n</li>\n</ol>\n<blockquote>\n<p>/etc/nginx/nginx.conf</p>\n</blockquote>\n<p>查看日志命令 tailf -f log目录</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">user  nginx;   设置nginx服务的系统使用用户  </span><br><span class=\"line\">worker_processes  1;  工作进程数,一般和CPU数量相同</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;   nginx的错误日志  </span><br><span class=\"line\">pid        /var/run/nginx.pid;   nginx服务启动时的pid</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;每个进程允许的最大连接数 10000</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;//文件后缀和类型类型的对应关系</span><br><span class=\"line\">    default_type  application/octet-stream;//默认content-type</span><br><span class=\"line\"></span><br><span class=\"line\">    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '</span><br><span class=\"line\">                    '$status $body_bytes_sent \"$http_referer\" '</span><br><span class=\"line\">                    '\"$http_user_agent\" \"$http_x_forwarded_for\"';  //日志记录格式</span><br><span class=\"line\"></span><br><span class=\"line\">    access_log  /var/log/nginx/access.log  main;//默认访问日志 日志格式与log_format main 对应</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;//启用sendfile</span><br><span class=\"line\">    #tcp_nopush     on;//懒发送 客户端请求数据不会每次都时时相应 让数据塞满一次性发送给客户端（多用于下载、断点 续传）</span><br><span class=\"line\">    #tcp_nodelay on; // 默认开启 与nopush互斥 提高实时请求响应效率</span><br><span class=\"line\"></span><br><span class=\"line\">    keepalive_timeout  65;//超时时间是65秒</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;gzip压缩</span><br><span class=\"line\"></span><br><span class=\"line\">    include /etc/nginx/conf.d/*.conf;//包含的子配置文件</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>/etc/default.conf</p>\n</blockquote>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    # 用域名方式访问的地址</span><br><span class=\"line\">    server_name  localhost;  </span><br><span class=\"line\"></span><br><span class=\"line\">    #charset koi8-r; //编码</span><br><span class=\"line\">    #access_log  /var/log/nginx/host.access.log  main;  //访问日志文件和名称</span><br><span class=\"line\"></span><br><span class=\"line\">    # 代理</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:3000</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # 转发请求静态资源（js、css）规则</span><br><span class=\"line\">    location ~ .*\\.(html|js|css)$ &#123;</span><br><span class=\"line\">        # CORS</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">        add_header Access-Control-Allow-Methods GET,POST,DELETE;</span><br><span class=\"line\">        add_header Access-Control-Allow-Headers Content-Type;</span><br><span class=\"line\">        # 默认带上客户端cookie</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">        # 缓存1h</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">        # 开启gzip</span><br><span class=\"line\">        gzip on;</span><br><span class=\"line\">        # gzip压缩HTTP版本号 一般是1.1</span><br><span class=\"line\">        gzip_http_version 1.1;</span><br><span class=\"line\">        # gzip压缩等级 越大压缩率越高 1-9</span><br><span class=\"line\">        gzip_comp_level 2;</span><br><span class=\"line\">        # 默认不指定不会缓存css资源 需要指定text/css类型</span><br><span class=\"line\">        gzip_types application/javascript text/css;</span><br><span class=\"line\">        # 资源目录</span><br><span class=\"line\">        root /data/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 设置图片请求规则</span><br><span class=\"line\">    location ~ .*\\.(gif|png|jpg|webp)$ &#123;</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">        gzip on;</span><br><span class=\"line\">        gzip_http_version 1.1;</span><br><span class=\"line\">        gzip_comp_level 3;</span><br><span class=\"line\">        gzip_types image/jpeg image/png image/gif image/webp;</span><br><span class=\"line\">        ## 防盗链</span><br><span class=\"line\">        valid_referers none blocked xx.xxx.xxx.xx;</span><br><span class=\"line\">        if ($invalid_referer) &#123;</span><br><span class=\"line\">            return 403;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        # 资源目录</span><br><span class=\"line\">        root /data/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ ^/download &#123;</span><br><span class=\"line\">        # 默认先查找当前目录下的后缀为.gz文件 有直接返回给客户端 不需要再压缩</span><br><span class=\"line\">        # linux下运行gzip 文件名会生成压缩gz文件</span><br><span class=\"line\">        # url最直接访问该文件路径就会自动启动下载该资源</span><br><span class=\"line\">        gzip_static on;</span><br><span class=\"line\">        tcp_nopush on;  </span><br><span class=\"line\">        root /data/download;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;  //静态文件根目录</span><br><span class=\"line\">        index  index.html index.htm;  //首页的索引文件</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #error_page  404              /404.html;  //指定错误页面</span><br><span class=\"line\"></span><br><span class=\"line\">    # redirect server error pages to the static page /50x.html</span><br><span class=\"line\">    # 把后台错误重定向到静态的50x.html页面</span><br><span class=\"line\">    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">    location = /50x.html &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">    # 把PHP脚本9000端口上监听的FastCGI服务</span><br><span class=\"line\">    #location ~ \\.php$ &#123;</span><br><span class=\"line\">    #    root           html;</span><br><span class=\"line\">    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">    #    fastcgi_index  index.php;</span><br><span class=\"line\">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">    #    include        fastcgi_params;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 不允许访问.htaccess文件 只允许指定的ip访问</span><br><span class=\"line\">    location ~ /\\.ht &#123;</span><br><span class=\"line\">        allow 127.0.0.1</span><br><span class=\"line\">        deny  all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>实现负载均衡</p>\n</blockquote>\n<ol>\n<li>\n<p>解决高并发、海量数据问题</p>\n</li>\n<li>\n<p>配置类型</p>\n<ol>\n<li>轮询（默认） 每个请求按照时间顺序逐一分配不同的后端服务器；</li>\n<li>ip_hash 每个请求按访问ip的hash结果分配，这样每个访客固定放一个后端服务器，可以解决session的问题；</li>\n<li>weight（加权轮询）指定轮询策略，weight和访问比率成正比，用于后端服务器性能不均的情况；</li>\n<li>least_conn 最小连接数，哪个连接少就分给谁。</li>\n</ol>\n<p>集群状态：</p>\n</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">状态</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">down</td>\n<td style=\"text-align:left\">不参与负载均衡</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">backup</td>\n<td style=\"text-align:left\">备份的服务器</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">max_fails</td>\n<td style=\"text-align:left\">允许请求失败的次数</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">fail_timeout</td>\n<td style=\"text-align:left\">经过max_fails失败后，服务暂停的时间</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">max_conts</td>\n<td style=\"text-align:left\">限制最大的接收的连接数</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream test1 &#123;</span><br><span class=\"line\">    ip_hsah;</span><br><span class=\"line\">    server http://localhost:3000 weight=2;</span><br><span class=\"line\">    server http://localhost:4000 weight=1;</span><br><span class=\"line\">    server http://localhost:5000 down;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    # 访问负载均衡构造的集群</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        # 和upstrem的name对应</span><br><span class=\"line\">        proxy_pass http://test1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test1.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:3000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test2.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:4000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name www.test3.com;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:5000;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>此时访问<code>www.test.com</code>通过代理到访问<code>www.test1.com</code>，而访问test1的请求被负载均衡按照策略访问test1或者test2</p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cjx3bm2yo0001bi1psucuvo9m","tag_id":"cjx3bm2yu0005bi1prpw48gm4","_id":"cjx3bm2z1000bbi1pdnag8i2d"},{"post_id":"cjx3bm2ys0003bi1p06cy5trz","tag_id":"cjx3bm2z1000abi1phwijdqcr","_id":"cjx3bm2z3000dbi1pmw1z6en7"},{"post_id":"cjx3bm2yw0006bi1p5l4uiys8","tag_id":"cjx3bm2z2000cbi1pe3segacg","_id":"cjx3bm2z3000fbi1p9m3f9lqh"},{"post_id":"cjx3bm2yy0008bi1pcza4ek3m","tag_id":"cjx3bm2z3000ebi1pn004czt8","_id":"cjx3bm2z4000hbi1p0rwn0rq8"},{"post_id":"cjx3bm2yz0009bi1pwsvxx4wp","tag_id":"cjx3bm2z4000gbi1p5fr2hm9v","_id":"cjx3bm2z4000ibi1p3fhcsra0"},{"post_id":"cjx3bm2ze000jbi1pe831uxs5","tag_id":"cjx3bm2zg000kbi1pgv5h50a5","_id":"cjx3bm2zi000lbi1psv0cmslk"}],"Tag":[{"name":"python","_id":"cjx3bm2yu0005bi1prpw48gm4"},{"name":"docker","_id":"cjx3bm2z1000abi1phwijdqcr"},{"name":"tool","_id":"cjx3bm2z2000cbi1pe3segacg"},{"name":"node","_id":"cjx3bm2z3000ebi1pn004czt8"},{"name":"随笔","_id":"cjx3bm2z4000gbi1p5fr2hm9v"},{"name":"nginx","_id":"cjx3bm2zg000kbi1pgv5h50a5"}]}}